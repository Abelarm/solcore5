
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Analytic solar cells calculator &#8212; Solcore 5.0.0 documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Poisson - Drift-Diffusion solver (PDD)" href="../PDD/DDsolver.html" />
    <link rel="prev" title="Light Sources" href="../spectral/spectral.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../PDD/DDsolver.html" title="Poisson - Drift-Diffusion solver (PDD)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../spectral/spectral.html" title="Light Sources"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Solcore 5.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="analytic-solar-cells-calculator">
<h1>Analytic solar cells calculator<a class="headerlink" href="#analytic-solar-cells-calculator" title="Permalink to this headline">¶</a></h1>
<p><strong>WARNING: Documentation not updated for Solcore 5</strong></p>
<p>This package include the tools to calculate, using an analytical approach, the quantum efficiency or the IV characteristics of a solar cell (single junction or multi-junction). The tools that can be accessed directly when importing this package are:</p>
<ul class="simple">
<li>multijunctionIV</li>
<li>spectral_response_all_junctions</li>
</ul>
<p>Check below for other tools that might be available when importing the modules within this package.</p>
<div class="section" id="quantum-efficiency-calculator">
<span id="id1"></span><h2>Quantum efficiency calculator<a class="headerlink" href="#quantum-efficiency-calculator" title="Permalink to this headline">¶</a></h2>
<p>This module calculates the quantum efficiency of any number of junctions. It uses the diffusion coefficients, diffusion lengths and the depletion aproximation to find out the fraction of photon that can be collected as a function or energy.</p>
<p>Contrary to the <a class="reference internal" href="#iv-calculator"><span class="std std-ref">Multi-junction current voltage calculator</span></a>, calculating the QE requires a substantial amount of information related to the material properties for each of the junctions and each of the layers that form each junction. In the next example we show the structure definition for calculating the QE of a GaInP/InGaAs/Ge tripple junction solar cell. Each subcell is a PN junction - requiring therefore two materials, one for the P and the other for the N side - and also includes a window layer and an AR coating.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">solcore</span> <span class="k">import</span> <span class="n">siUnits</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="n">asUnit</span>
<span class="kn">from</span> <span class="nn">solcore.constants</span> <span class="k">import</span> <span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">vacuum_permittivity</span>
<span class="kn">from</span> <span class="nn">solcore.structure</span> <span class="k">import</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">Junction</span><span class="p">,</span> <span class="n">Layer</span>
<span class="kn">from</span> <span class="nn">solcore.state</span> <span class="k">import</span> <span class="n">State</span>
<span class="kn">from</span> <span class="nn">solcore.interpolate</span> <span class="k">import</span> <span class="n">interp1d</span>

<span class="c1"># We need to build the solar cell layer by layer.</span>
<span class="c1"># All the materials will be stored in this list, from top to bottom.</span>
<span class="n">all_materials</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># We start from the AR coating. We only need this to define the reflexion of the cell.</span>
<span class="c1"># In this case, we load it from an an external file</span>
<span class="k">def</span> <span class="nf">this_dir_file</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">f</span><span class="p">)</span>

<span class="n">refl_nm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">this_dir_file</span><span class="p">(</span><span class="s2">&quot;MgF-ZnS_AR.csv&quot;</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">refl_J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">h</span> <span class="o">*</span> <span class="n">c</span> <span class="o">/</span> <span class="n">siUnits</span><span class="p">(</span><span class="n">refl_nm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;nm&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">refl_nm</span><span class="p">[</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

<span class="c1"># Next is the window layer, made of AlInP. We load the absorption coefficent of AlInP from an external file, too</span>
<span class="n">AlInP</span> <span class="o">=</span> <span class="n">material</span><span class="p">(</span><span class="s2">&quot;AlInP&quot;</span><span class="p">)</span>
<span class="n">window_material</span> <span class="o">=</span> <span class="n">AlInP</span><span class="p">(</span><span class="n">Al</span><span class="o">=</span><span class="mf">0.52</span><span class="p">)</span>
<span class="n">window_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">this_dir_file</span><span class="p">(</span><span class="s2">&quot;alinp.csv&quot;</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">window_material</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="n">window_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;eV&quot;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">window_alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window_material</span><span class="p">)</span>

<span class="c1"># TOP CELL - GaInP</span>
<span class="c1"># Now we build the top cell, which requires the n and p sides of GaInP.</span>
<span class="c1"># We also load the absorption coefficient from an external file. We also add some extra parameters needed for the</span>
<span class="c1"># calculation such as the minority carriers diffusion lengths</span>
<span class="n">InGaP</span> <span class="o">=</span> <span class="n">material</span><span class="p">(</span><span class="s2">&quot;GaInP&quot;</span><span class="p">)</span>
<span class="n">top_cell_n_material</span> <span class="o">=</span> <span class="n">InGaP</span><span class="p">(</span><span class="n">In</span><span class="o">=</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">Nd</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mf">2e18</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
<span class="n">top_cell_p_material</span> <span class="o">=</span> <span class="n">InGaP</span><span class="p">(</span><span class="n">In</span><span class="o">=</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">Na</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mf">1e17</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="n">top_cell_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">this_dir_file</span><span class="p">(</span><span class="s2">&quot;in048ga052p.csv&quot;</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">top_cell_n_material</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="n">top_cell_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;eV&quot;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">top_cell_alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">top_cell_p_material</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">top_cell_n_material</span><span class="o">.</span><span class="n">alphaE</span>
<span class="n">top_cell_n_material</span><span class="o">.</span><span class="n">hole_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;200nm&quot;</span><span class="p">)</span>
<span class="n">top_cell_p_material</span><span class="o">.</span><span class="n">electron_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;1um&quot;</span><span class="p">)</span>

<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">top_cell_n_material</span><span class="p">)</span>
<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">top_cell_p_material</span><span class="p">)</span>

<span class="c1"># MID CELL  - InGaAs</span>
<span class="c1"># The same thing.</span>
<span class="n">InGaAs</span> <span class="o">=</span> <span class="n">material</span><span class="p">(</span><span class="s2">&quot;InGaAs&quot;</span><span class="p">)</span>
<span class="n">mid_cell_n_material</span> <span class="o">=</span> <span class="n">InGaAs</span><span class="p">(</span><span class="n">In</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Nd</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mf">3e18</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
<span class="n">mid_cell_p_material</span> <span class="o">=</span> <span class="n">InGaAs</span><span class="p">(</span><span class="n">In</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Na</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mf">1e17</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="n">mid_cell_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">this_dir_file</span><span class="p">(</span><span class="s2">&quot;in01gaas.csv&quot;</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">mid_cell_n_material</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="n">mid_cell_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;eV&quot;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">mid_cell_alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mid_cell_p_material</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">mid_cell_n_material</span><span class="o">.</span><span class="n">alphaE</span>
<span class="n">mid_cell_n_material</span><span class="o">.</span><span class="n">hole_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;500nm&quot;</span><span class="p">)</span>
<span class="n">mid_cell_p_material</span><span class="o">.</span><span class="n">electron_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;5um&quot;</span><span class="p">)</span>

<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mid_cell_n_material</span><span class="p">)</span>
<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mid_cell_p_material</span><span class="p">)</span>

<span class="c1"># BOTTOM CELL - Ge</span>
<span class="c1"># Idem</span>
<span class="n">Ge</span> <span class="o">=</span> <span class="n">material</span><span class="p">(</span><span class="s2">&quot;Ge&quot;</span><span class="p">)</span>
<span class="n">bot_cell_n_material</span> <span class="o">=</span> <span class="n">Ge</span><span class="p">(</span><span class="n">Nd</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mf">2e18</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
<span class="n">bot_cell_p_material</span> <span class="o">=</span> <span class="n">Ge</span><span class="p">(</span><span class="n">Na</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mf">1e17</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="n">Ge_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">this_dir_file</span><span class="p">(</span><span class="s2">&quot;Ge-Palik.csv&quot;</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">Ge</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="n">Ge_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;eV&#39;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">Ge_alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">bot_cell_n_material</span><span class="o">.</span><span class="n">hole_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;800nm&quot;</span><span class="p">)</span>
<span class="n">bot_cell_p_material</span><span class="o">.</span><span class="n">electron_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;50um&quot;</span><span class="p">)</span>

<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bot_cell_n_material</span><span class="p">)</span>
<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bot_cell_p_material</span><span class="p">)</span>

<span class="c1"># We add some other properties to the materials, assumed the same in all cases.</span>
<span class="c1"># If different, we should have added them above.</span>
<span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">all_materials</span><span class="p">:</span>
    <span class="n">mat</span><span class="o">.</span><span class="n">hole_mobility</span> <span class="o">=</span> <span class="mf">3.4e-3</span>
    <span class="n">mat</span><span class="o">.</span><span class="n">electron_mobility</span> <span class="o">=</span> <span class="mf">5e-2</span>
    <span class="n">mat</span><span class="o">.</span><span class="n">dielectric_constant</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">vacuum_permittivity</span>

<span class="c1"># And, finally, we put everything together, adding also the surface recombination velocities.</span>
<span class="n">triplejunction</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Layer</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="n">window_material</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;25nm&quot;</span><span class="p">)),</span>
        <span class="n">Junction</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;100nm&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">top_cell_n_material</span><span class="p">),</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;600nm&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">top_cell_p_material</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="n">sn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">sp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">Junction</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;100nm&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">mid_cell_n_material</span><span class="p">),</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;3.5um&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">mid_cell_p_material</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="n">sn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">sp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">Junction</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;400nm&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">bot_cell_n_material</span><span class="p">),</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;100um&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">bot_cell_p_material</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="n">sn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">sp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Now the &#39;solar_cell&#39; object below contains all the information regarding the solar cell. So, we use it</span>
<span class="n">solar_cell</span> <span class="o">=</span> <span class="n">State</span><span class="p">()</span>
<span class="n">solar_cell</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">triplejunction</span>
<span class="n">solar_cell</span><span class="o">.</span><span class="n">reflectivity</span> <span class="o">=</span> <span class="n">refl_J</span>
</pre></div>
</div>
<p>So far, it has been only the definition of the structure. To actually calculate the quantum efficiency we need to add the energy range in which we want to calculate the results and call the <em>spectral_response_all_junctions</em> function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">solcore.analytic_solar_cells</span> <span class="k">as</span> <span class="nn">ASC</span>

<span class="c1"># The energy in SI units</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="s2">&quot;eV&quot;</span><span class="p">)</span>

<span class="c1"># We add this energy to the solar cell structure.</span>
<span class="n">solar_cell</span><span class="o">.</span><span class="n">energies</span> <span class="o">=</span> <span class="n">E</span>

<span class="c1"># We run the simulation. Verbose=True ensures that we have a full report of the parameters printed on the screen</span>
<span class="n">qe_result</span> <span class="o">=</span> <span class="n">ASC</span><span class="o">.</span><span class="n">spectral_response_all_junctions</span><span class="p">(</span><span class="n">solar_cell</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Below there is an image of the QE corresponding to the three junctions as a function of wavelength, which is a more common representation.</p>
<img alt="../_images/qe_mj.png" class="align-center" src="../_images/qe_mj.png" />
<p>Since we didn’t define any solar spectrum or solar cell geometry, we can not have the short circuit current for each of the junctions. We add that information to the solar_cell object above and sun again the solver. We are assuming we have some concentration optics and metallisation on top of the solar cell:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">solcore.solar_spectrum</span> <span class="k">import</span> <span class="n">calculate_spectrum_spectral2</span>

<span class="c1"># Configure cell geometry and concentration</span>
<span class="c1"># Cell area is stated to be 7mm x 7mm</span>
<span class="n">cell_area</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="mf">0.7</span> <span class="o">/</span> <span class="mf">1e4</span>  <span class="c1"># expressed in m-2</span>
<span class="c1"># Geometrical concentration is 1000, but the optical efficiency is approximately 0.85 and cell metalisation shading 8%</span>
<span class="n">concentration_factor</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mf">0.85</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.08</span><span class="p">)</span>

<span class="c1"># We create a solar spectrum using SPECTRAL2 and the default configuration</span>
<span class="c1"># - See documentation and example of that package for more info</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">calculate_spectrum_spectral2</span><span class="p">()</span>

<span class="c1"># We use the spectrum is in SI units: Watts m-2 joule-1.</span>
<span class="n">incident_x_J_y_per_J</span> <span class="o">=</span> <span class="n">spectrum</span><span class="p">[</span><span class="s2">&quot;incident spectrum energy si&quot;</span><span class="p">]</span>
<span class="n">incident_function</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">incident_x_J_y_per_J</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">concentration_factor</span> <span class="o">*</span> <span class="n">cell_area</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">incident_x_J_y_per_J</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">power_density</span> <span class="o">=</span> <span class="n">spectrum</span><span class="p">[</span><span class="s2">&quot;incident power density&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Power density = </span><span class="si">{:.2f}</span><span class="s1"> W m-2</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">power_density</span><span class="p">))</span>

<span class="c1"># We already have the energies, as defined above</span>
<span class="n">solar_cell</span><span class="o">.</span><span class="n">incident_light</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">incident_function</span><span class="p">(</span><span class="n">E</span><span class="p">)</span> <span class="o">/</span> <span class="n">E</span> <span class="p">)</span>
<span class="n">qe_result</span> <span class="o">=</span> <span class="n">ASC</span><span class="o">.</span><span class="n">spectral_response_all_junctions</span><span class="p">(</span><span class="n">solar_cell</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subcell photocurrent density [mA cm-2]:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Jsc(Top) = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">1e3</span> <span class="o">*</span> <span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">cell_area</span> <span class="o">*</span> <span class="mf">1e4</span> <span class="o">*</span> <span class="n">concentration_factor</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Jsc(Mid) = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">1e3</span> <span class="o">*</span> <span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">cell_area</span> <span class="o">*</span> <span class="mf">1e4</span> <span class="o">*</span> <span class="n">concentration_factor</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Jsc(Bot) = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">1e3</span> <span class="o">*</span> <span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">cell_area</span> <span class="o">*</span> <span class="mf">1e4</span> <span class="o">*</span> <span class="n">concentration_factor</span><span class="p">)))</span>
</pre></div>
</div>
<p>After these modifications, the quantum efficiency has not changed, but we can have the short circuit current density of each of the subcells:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Power</span> <span class="n">density</span> <span class="o">=</span> <span class="mf">891.90</span> <span class="n">W</span> <span class="n">m</span><span class="o">-</span><span class="mi">2</span>

<span class="n">Subcell</span> <span class="n">photocurrent</span> <span class="n">density</span> <span class="p">[</span><span class="n">mA</span> <span class="n">cm</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Top</span><span class="p">)</span> <span class="o">=</span> <span class="mf">9.73</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Mid</span><span class="p">)</span> <span class="o">=</span> <span class="mf">12.02</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Bot</span><span class="p">)</span> <span class="o">=</span> <span class="mf">25.18</span>
</pre></div>
</div>
<span class="target" id="module-solcore.analytic_solar_cells.QE"></span><dl class="function">
<dt id="solcore.analytic_solar_cells.QE.spectral_response_all_junctions">
<code class="descclassname">solcore.analytic_solar_cells.QE.</code><code class="descname">spectral_response_all_junctions</code><span class="sig-paren">(</span><em>solar_cell</em>, <em>incident_light=None</em>, <em>energy=None</em>, <em>V=0</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/QE.html#spectral_response_all_junctions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.QE.spectral_response_all_junctions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the spectral response of any number of junctions using analytical diode equations as described in
J. Nelson’s book “The Physics of Solar Cells” (2003). All parameters must be in SI units. It only works for
homojunctions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>solar_cell</strong> – <p>A structure object with one or more Junction objects and a few optional parameters. Each junction
is made of a sequence of <em>Layers</em> (with a thickness, a material and a role) and the surface recombination
velocities for electrons and holes. Optional attributes for the structure are:</p>
<blockquote>
<div><ul>
<li>shading: (optional) Shading loses.</li>
<li>reflectivity: (optional) Function that calculates the reflectivity as a function of energy (in J).</li>
</ul>
</div></blockquote>
</li>
<li><strong>incident_light</strong> – (optional) 2D array containing the energies and the spectral power density (in photons m-2 J-1).</li>
<li><strong>energy</strong> – (optional) energies at which to calculate the QE. If not provided, the range of the incident ligth</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>is used and if that is not defined, a “sensible” range is used.
:param V: The voltage at which to perform the calculations (in V)
:param verbose: If the information about the calculation must be printed (default = FALSE).
:return: A dictionary containing, as a function of energy:</p>
<blockquote>
<div><ul class="simple">
<li>junctions: A list containing the QE data for each junction</li>
<li>transmitted: The transmitted power density</li>
<li>transmitted_fraction: The fraction of transmitted power</li>
<li>passive_loss: The passive losses (light absorbed in the encapsulants, AR coatings, window layers, etc)</li>
<li>reflected: reflected power density</li>
<li>reflected_fraction: Fraction of reflected power</li>
<li>e: The energy values</li>
</ul>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="solcore.analytic_solar_cells.QE.calculate_junction_sr">
<code class="descclassname">solcore.analytic_solar_cells.QE.</code><code class="descname">calculate_junction_sr</code><span class="sig-paren">(</span><em>junc</em>, <em>energies</em>, <em>bs</em>, <em>bs_initial</em>, <em>V</em>, <em>printParameters=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/QE.html#calculate_junction_sr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.QE.calculate_junction_sr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the total quantum efficiency, the QE splitted by regions, photocurrent and other parameters for a
given junction at a given voltage.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>junc</strong> – The junction object</li>
<li><strong>energies</strong> – The energies at which to perform the calculation</li>
<li><strong>bs</strong> – The spectral power density reaching the junction</li>
<li><strong>bsInitial</strong> – The initial power density</li>
<li><strong>V</strong> – The voltage at which to perform the calculations (not implemented, yet)</li>
<li><strong>printParameters</strong> – If a list of all parameters must be printed</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="solcore.analytic_solar_cells.QE.get_j_top">
<code class="descclassname">solcore.analytic_solar_cells.QE.</code><code class="descname">get_j_top</code><span class="sig-paren">(</span><em>x</em>, <em>w</em>, <em>l</em>, <em>s</em>, <em>d</em>, <em>alpha</em>, <em>bs</em>, <em>V</em>, <em>minority</em>, <em>T</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/QE.html#get_j_top"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.QE.get_j_top" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="solcore.analytic_solar_cells.QE.get_j_bot">
<code class="descclassname">solcore.analytic_solar_cells.QE.</code><code class="descname">get_j_bot</code><span class="sig-paren">(</span><em>x</em>, <em>w</em>, <em>l</em>, <em>s</em>, <em>d</em>, <em>alpha</em>, <em>bs</em>, <em>V</em>, <em>minority</em>, <em>T</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/QE.html#get_j_bot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.QE.get_j_bot" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="multi-junction-current-voltage-calculator">
<span id="iv-calculator"></span><h2>Multi-junction current voltage calculator<a class="headerlink" href="#multi-junction-current-voltage-calculator" title="Permalink to this headline">¶</a></h2>
<p>This module contanes all the functions necessary to calculate the IV curve of single and multi-junction solar cells using the2-diode equation as the starting point. In addition to the <em>multijunctionIV</em> function that can invoked directly when importing the solcore.analytic_solar_cells package, this module containes several tools to calculate the reverse saturation currents under the radiative aproximation, using a radiative efficiency or based on the knowledge of Voc and Jsc.</p>
<p>Here is an example on how to use this module to calculate the IV curve of a triple junction solar cell, using the results of the Example 3 above (see <a class="reference internal" href="#quantum-efficiency-calculator"><span class="std std-ref">Quantum efficiency calculator</span></a>) and ploting them with the <em>solcore.graphing</em> package:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">solcore.structure</span> <span class="k">import</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">Junction</span>
<span class="kn">import</span> <span class="nn">solcore.analytic_solar_cells</span> <span class="k">as</span> <span class="nn">ASC</span>
<span class="kn">from</span> <span class="nn">solcore.state</span> <span class="k">import</span> <span class="n">State</span>
<span class="kn">from</span> <span class="nn">solcore.graphing</span> <span class="k">import</span> <span class="o">*</span>

<span class="c1"># We import the QE results obtained in ASC_example_3 which contain the short circuit currents of each junction</span>
<span class="c1"># when the solar cell is illuminated with the default SPECTAL2 spectrum</span>
<span class="kn">from</span> <span class="nn">ASC_example_3</span> <span class="k">import</span> <span class="n">qe_result</span><span class="p">,</span> <span class="n">power_density</span><span class="p">,</span> <span class="n">cell_area</span><span class="p">,</span> <span class="n">concentration_factor</span>

<span class="c1"># Ref temperature ºC. Let&#39;s say we have the reverse saturation currents J01 and J02 of each junction at a</span>
<span class="c1"># reference temperature and we want the IV curve at a different one. We have to make a correction to the J01 and J02</span>
<span class="n">cell_temp</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">ref_temp</span> <span class="o">=</span> <span class="mi">25</span>

<span class="n">Tcell</span> <span class="o">=</span> <span class="mi">273</span> <span class="o">+</span> <span class="n">cell_temp</span>
<span class="n">Tref</span> <span class="o">=</span> <span class="mi">273</span> <span class="o">+</span> <span class="n">ref_temp</span>

<span class="c1"># The IV data will be stored in a State object. We create it, including the cell and reference temperatures.</span>
<span class="n">IV_calculation_state</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Tcell</span><span class="p">,</span> <span class="n">Tref</span><span class="o">=</span><span class="n">Tref</span><span class="p">)</span>

<span class="c1"># From the QE object we get the short circuit currents</span>
<span class="n">Isc_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">],</span> <span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">],</span> <span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">]]</span>

<span class="c1"># And we create a list with the reverse saturation currents. In this case, we don&#39;t calculate them but just assume we</span>
<span class="c1"># have them from somewhere.</span>
<span class="n">I01_array</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.93e-24</span><span class="p">,</span> <span class="mf">1.0e-21</span><span class="p">,</span> <span class="mf">4.93e-6</span><span class="p">]</span>
<span class="n">I02_array</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.28e-15</span><span class="p">,</span> <span class="mf">2.7e-10</span><span class="p">,</span> <span class="mf">1.0e-5</span><span class="p">]</span>

<span class="c1"># This is the structure to calculate.</span>
<span class="n">IV_calculation_state</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Junction</span><span class="p">(</span><span class="n">Eg</span><span class="o">=</span><span class="mf">1.9</span><span class="p">,</span> <span class="n">j01</span><span class="o">=</span><span class="n">I01_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">j02</span><span class="o">=</span><span class="n">I02_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">R_shunt</span><span class="o">=</span><span class="mf">3e6</span><span class="p">,</span>
                 <span class="n">R_series</span><span class="o">=</span><span class="mf">0.0236</span><span class="p">,</span> <span class="n">n1</span><span class="o">=</span><span class="mf">1.00</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">photocurrent</span><span class="o">=</span><span class="n">Isc_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">Junction</span><span class="p">(</span><span class="n">Eg</span><span class="o">=</span><span class="mf">1.4</span><span class="p">,</span> <span class="n">j01</span><span class="o">=</span><span class="n">I01_array</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">j02</span><span class="o">=</span><span class="n">I02_array</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">R_shunt</span><span class="o">=</span><span class="mf">1.5e6</span><span class="p">,</span>
                 <span class="n">R_series</span><span class="o">=</span><span class="mf">0.0012</span><span class="p">,</span> <span class="n">n1</span><span class="o">=</span><span class="mf">1.00</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">photocurrent</span><span class="o">=</span><span class="n">Isc_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="n">Junction</span><span class="p">(</span><span class="n">Eg</span><span class="o">=</span><span class="mf">0.66</span><span class="p">,</span> <span class="n">j01</span><span class="o">=</span><span class="n">I01_array</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">j02</span><span class="o">=</span><span class="n">I02_array</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">R_shunt</span><span class="o">=</span><span class="mi">115</span><span class="p">,</span>
                 <span class="n">R_series</span><span class="o">=</span><span class="mf">8e-4</span><span class="p">,</span> <span class="n">n1</span><span class="o">=</span><span class="mf">1.00</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">photocurrent</span><span class="o">=</span><span class="n">Isc_array</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># We solve it, including explicitely the range of voltages we are interested</span>
<span class="n">IV_result</span> <span class="o">=</span> <span class="n">ASC</span><span class="o">.</span><span class="n">multijunctionIV</span><span class="p">(</span><span class="n">IV_calculation_state</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>

<span class="c1"># We use the tools of the graphing package to get a nice plot of the IV curves.</span>
<span class="n">junction_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">]</span>
<span class="n">graph_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">GraphData</span><span class="p">(</span><span class="n">iv</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Junction </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">junction_colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
               <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">iv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;junction IV&quot;</span><span class="p">])]</span>
<span class="n">graph_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GraphData</span><span class="p">(</span><span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;IV&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Multijunction&quot;</span><span class="p">))</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">graph_lines</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Bias (V)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Current (A)&quot;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">eta</span> <span class="o">=</span> <span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;Pmpp&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">power_density</span> <span class="o">*</span> <span class="n">cell_area</span> <span class="o">*</span> <span class="n">concentration_factor</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The solar cell properties are: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Isc = </span><span class="si">{:.2f}</span><span class="s1"> mA cm-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mf">1e3</span> <span class="o">*</span> <span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;Isc&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">cell_area</span> <span class="o">*</span> <span class="mf">1e4</span> <span class="o">*</span> <span class="n">concentration_factor</span><span class="p">)</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Voc = </span><span class="si">{:.2f}</span><span class="s1"> V&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;Voc&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">FF = </span><span class="si">{:.2f}</span><span class="s1"> % &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;FF&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Eta = </span><span class="si">{:.2f}</span><span class="s1"> %&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eta</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
<p>The result of the above coe will be the figure below and the following output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Power</span> <span class="n">density</span> <span class="o">=</span> <span class="mf">891.90</span> <span class="n">W</span> <span class="n">m</span><span class="o">-</span><span class="mi">2</span>

<span class="n">Subcell</span> <span class="n">photocurrent</span> <span class="n">density</span> <span class="p">[</span><span class="n">mA</span> <span class="n">cm</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Top</span><span class="p">)</span> <span class="o">=</span> <span class="mf">9.73</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Mid</span><span class="p">)</span> <span class="o">=</span> <span class="mf">12.02</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Bot</span><span class="p">)</span> <span class="o">=</span> <span class="mf">25.18</span>

<span class="n">The</span> <span class="n">solar</span> <span class="n">cell</span> <span class="n">properties</span> <span class="n">are</span><span class="p">:</span>
    <span class="n">Isc</span> <span class="o">=</span> <span class="mf">9.73</span> <span class="n">mA</span> <span class="n">cm</span><span class="o">-</span><span class="mi">2</span>
    <span class="n">Voc</span> <span class="o">=</span> <span class="mf">3.34</span> <span class="n">V</span>
    <span class="n">FF</span> <span class="o">=</span> <span class="mf">89.20</span> <span class="o">%</span>
    <span class="n">Eta</span> <span class="o">=</span> <span class="mf">32.51</span> <span class="o">%</span>
</pre></div>
</div>
<img alt="../_images/iv_mj.png" class="align-center" src="../_images/iv_mj.png" />
<span class="target" id="module-solcore.analytic_solar_cells.IV"></span><dl class="function">
<dt id="solcore.analytic_solar_cells.IV.iv_multijunction">
<code class="descclassname">solcore.analytic_solar_cells.IV.</code><code class="descname">iv_multijunction</code><span class="sig-paren">(</span><em>solar_cell</em>, <em>options</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/IV.html#iv_multijunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.IV.iv_multijunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the overall IV characteristics of any number of junctions numerically at the requested voltage
points. If photocurrent is not provided, the resultant IV characteristics are purely recombination currents,
otherwise light IVs are returned.</p>
<dl class="docutils">
<dt>In the end, the soalr_cell object is updated with an “iv” attribute containing a dictionary with:</dt>
<dd>“IV”: (V, I) Calculated IV characteristics
“junction IV”: [(V junc 1, I junc 1), (V junc 2, I junc 2), …]
“Rseries IV”: (V, I) Calculated IV characteristics of the series resistance
“coupled IV”: For each junction but for the first one, a list with the coupled current coming form the upper junctions.
“Isc”, Voc”, “P”, “FF” and “Eta”: In case of mpp = True and light IV.</dd>
<dt>The sign convention is:</dt>
<dd><ul class="first last simple">
<li>Photocurrents: Positive.</li>
<li>Dark Currents: Negative</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>solar_cell</strong> – A solar cell object with one or more junctions. The IV of the individual junctions must have been calculated already.</li>
<li><strong>kwargs</strong> – A dictionary containing, at least, the following elements:
- mpp: (Boolean) If Isc, Voc, FF, Vmpp, Impp and Pmpp must be calculated.
- voltages: Array of voltages in which to calculate the data
- light_iv: (Boolean) if light IV is being calculated</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="solcore.analytic_solar_cells.IV.solve_radiative_coupling">
<code class="descclassname">solcore.analytic_solar_cells.IV.</code><code class="descname">solve_radiative_coupling</code><span class="sig-paren">(</span><em>solar_cell</em>, <em>options</em>, <em>V_junction_array</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/IV.html#solve_radiative_coupling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.IV.solve_radiative_coupling" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the radiative IV curve of a MJ solar cell in the presence of radiative coupling between subcells.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>solar_cell</strong> – The MJ solar cell structure</li>
<li><strong>options</strong> – General options of the solver</li>
<li><strong>V_junction_array</strong> – Array with all the junction voltages without coupling. Only the first element is used, actually.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A tupple with J, V_junction_array in the presence of coupling and the coupled current</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Analytic solar cells calculator</a><ul>
<li><a class="reference internal" href="#quantum-efficiency-calculator">Quantum efficiency calculator</a></li>
<li><a class="reference internal" href="#multi-junction-current-voltage-calculator">Multi-junction current voltage calculator</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../spectral/spectral.html"
                        title="previous chapter">Light Sources</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../PDD/DDsolver.html"
                        title="next chapter">Poisson - Drift-Diffusion solver (PDD)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/ASC/ASC.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../PDD/DDsolver.html" title="Poisson - Drift-Diffusion solver (PDD)"
             >next</a> |</li>
        <li class="right" >
          <a href="../spectral/spectral.html" title="Light Sources"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Solcore 5.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, Quantum Photovoltaics Group, Imperial College London.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>