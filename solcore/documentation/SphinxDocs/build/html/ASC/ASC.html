<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Analytic solar cells calculator &mdash; Solcore 4.1.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '4.1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="Solcore 4.1.0 documentation" href="../index.html" />
    <link rel="next" title="Poisson - Drift-Diffusion solver (PDD)" href="../PDD/DDsolver.html" />
    <link rel="prev" title="Spectral irradiance model and database" href="../spectral/spectral.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../PDD/DDsolver.html" title="Poisson - Drift-Diffusion solver (PDD)"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="../spectral/spectral.html" title="Spectral irradiance model and database"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Solcore 4.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="analytic-solar-cells-calculator">
<h1>Analytic solar cells calculator<a class="headerlink" href="#analytic-solar-cells-calculator" title="Permalink to this headline">¶</a></h1>
<p>This package include the tools to calculate, using an analytical approach, the quantum efficiency or the IV characteristics of a solar cell (single junction or multi-junction). The tools that can be accessed directly when importing this package are:</p>
<ul class="simple">
<li>multijunctionIV</li>
<li>spectral_response_all_junctions</li>
</ul>
<p>Check below for other tools that might be available when importing the modules within this package.</p>
<div class="section" id="quantum-efficiency-calculator">
<span id="id1"></span><h2>Quantum efficiency calculator<a class="headerlink" href="#quantum-efficiency-calculator" title="Permalink to this headline">¶</a></h2>
<p>This module calculates the quantum efficiency of any number of junctions. It uses the diffusion coefficients, diffusion lengths and the depletion aproximation to find out the fraction of photon that can be collected as a function or energy.</p>
<p>Contrary to the <a class="reference internal" href="#iv-calculator"><span class="std std-ref">Multi-junction current voltage calculator</span></a>, calculating the QE requires a substantial amount of information related to the material properties for each of the junctions and each of the layers that form each junction. In the next example we show the structure definition for calculating the QE of a GaInP/InGaAs/Ge tripple junction solar cell. Each subcell is a PN junction - requiring therefore two materials, one for the P and the other for the N side - and also includes a window layer and an AR coating.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">solcore</span> <span class="k">import</span> <span class="n">siUnits</span><span class="p">,</span> <span class="n">material</span><span class="p">,</span> <span class="n">si</span><span class="p">,</span> <span class="n">asUnit</span>
<span class="kn">from</span> <span class="nn">solcore.constants</span> <span class="k">import</span> <span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">vacuum_permittivity</span>
<span class="kn">from</span> <span class="nn">solcore.structure</span> <span class="k">import</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">Junction</span><span class="p">,</span> <span class="n">Layer</span>
<span class="kn">from</span> <span class="nn">solcore.state</span> <span class="k">import</span> <span class="n">State</span>
<span class="kn">from</span> <span class="nn">solcore.interpolate</span> <span class="k">import</span> <span class="n">interp1d</span>

<span class="c1"># We need to build the solar cell layer by layer.</span>
<span class="c1"># All the materials will be stored in this list, from top to bottom.</span>
<span class="n">all_materials</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># We start from the AR coating. We only need this to define the reflexion of the cell.</span>
<span class="c1"># In this case, we load it from an an external file</span>
<span class="k">def</span> <span class="nf">this_dir_file</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">__file__</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span> <span class="n">f</span><span class="p">)</span>

<span class="n">refl_nm</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">this_dir_file</span><span class="p">(</span><span class="s2">&quot;MgF-ZnS_AR.csv&quot;</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">refl_J</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">h</span> <span class="o">*</span> <span class="n">c</span> <span class="o">/</span> <span class="n">siUnits</span><span class="p">(</span><span class="n">refl_nm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;nm&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">refl_nm</span><span class="p">[</span><span class="mi">1</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span>

<span class="c1"># Next is the window layer, made of AlInP. We load the absorption coefficent of AlInP from an external file, too</span>
<span class="n">AlInP</span> <span class="o">=</span> <span class="n">material</span><span class="p">(</span><span class="s2">&quot;AlInP&quot;</span><span class="p">)</span>
<span class="n">window_material</span> <span class="o">=</span> <span class="n">AlInP</span><span class="p">(</span><span class="n">Al</span><span class="o">=</span><span class="mf">0.52</span><span class="p">)</span>
<span class="n">window_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">this_dir_file</span><span class="p">(</span><span class="s2">&quot;alinp.csv&quot;</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">window_material</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="n">window_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;eV&quot;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">window_alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window_material</span><span class="p">)</span>

<span class="c1"># TOP CELL - GaInP</span>
<span class="c1"># Now we build the top cell, which requires the n and p sides of GaInP.</span>
<span class="c1"># We also load the absorption coefficient from an external file. We also add some extra parameters needed for the</span>
<span class="c1"># calculation such as the minority carriers diffusion lengths</span>
<span class="n">InGaP</span> <span class="o">=</span> <span class="n">material</span><span class="p">(</span><span class="s2">&quot;GaInP&quot;</span><span class="p">)</span>
<span class="n">top_cell_n_material</span> <span class="o">=</span> <span class="n">InGaP</span><span class="p">(</span><span class="n">In</span><span class="o">=</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">Nd</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mi">2</span><span class="n">e18</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
<span class="n">top_cell_p_material</span> <span class="o">=</span> <span class="n">InGaP</span><span class="p">(</span><span class="n">In</span><span class="o">=</span><span class="mf">0.49</span><span class="p">,</span> <span class="n">Na</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mi">1</span><span class="n">e17</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="n">top_cell_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">this_dir_file</span><span class="p">(</span><span class="s2">&quot;in048ga052p.csv&quot;</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">top_cell_n_material</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="n">top_cell_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;eV&quot;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">top_cell_alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">top_cell_p_material</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">top_cell_n_material</span><span class="o">.</span><span class="n">alphaE</span>
<span class="n">top_cell_n_material</span><span class="o">.</span><span class="n">hole_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;200nm&quot;</span><span class="p">)</span>
<span class="n">top_cell_p_material</span><span class="o">.</span><span class="n">electron_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;1um&quot;</span><span class="p">)</span>

<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">top_cell_n_material</span><span class="p">)</span>
<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">top_cell_p_material</span><span class="p">)</span>

<span class="c1"># MID CELL  - InGaAs</span>
<span class="c1"># The same thing.</span>
<span class="n">InGaAs</span> <span class="o">=</span> <span class="n">material</span><span class="p">(</span><span class="s2">&quot;InGaAs&quot;</span><span class="p">)</span>
<span class="n">mid_cell_n_material</span> <span class="o">=</span> <span class="n">InGaAs</span><span class="p">(</span><span class="n">In</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Nd</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mi">3</span><span class="n">e18</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
<span class="n">mid_cell_p_material</span> <span class="o">=</span> <span class="n">InGaAs</span><span class="p">(</span><span class="n">In</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">Na</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mi">1</span><span class="n">e17</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="n">mid_cell_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">this_dir_file</span><span class="p">(</span><span class="s2">&quot;in01gaas.csv&quot;</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">mid_cell_n_material</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="n">mid_cell_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;eV&quot;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">mid_cell_alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                      <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mid_cell_p_material</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">mid_cell_n_material</span><span class="o">.</span><span class="n">alphaE</span>
<span class="n">mid_cell_n_material</span><span class="o">.</span><span class="n">hole_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;500nm&quot;</span><span class="p">)</span>
<span class="n">mid_cell_p_material</span><span class="o">.</span><span class="n">electron_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;5um&quot;</span><span class="p">)</span>

<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mid_cell_n_material</span><span class="p">)</span>
<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mid_cell_p_material</span><span class="p">)</span>

<span class="c1"># BOTTOM CELL - Ge</span>
<span class="c1"># Idem</span>
<span class="n">Ge</span> <span class="o">=</span> <span class="n">material</span><span class="p">(</span><span class="s2">&quot;Ge&quot;</span><span class="p">)</span>
<span class="n">bot_cell_n_material</span> <span class="o">=</span> <span class="n">Ge</span><span class="p">(</span><span class="n">Nd</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mi">2</span><span class="n">e18</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;n&quot;</span><span class="p">)</span>
<span class="n">bot_cell_p_material</span> <span class="o">=</span> <span class="n">Ge</span><span class="p">(</span><span class="n">Na</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="mi">1</span><span class="n">e17</span><span class="p">,</span> <span class="s2">&quot;cm-3&quot;</span><span class="p">),</span> <span class="n">role</span><span class="o">=</span><span class="s2">&quot;p&quot;</span><span class="p">)</span>
<span class="n">Ge_alpha</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">this_dir_file</span><span class="p">(</span><span class="s2">&quot;Ge-Palik.csv&quot;</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
<span class="n">Ge</span><span class="o">.</span><span class="n">alphaE</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">siUnits</span><span class="p">(</span><span class="n">Ge_alpha</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;eV&#39;</span><span class="p">),</span> <span class="n">y</span><span class="o">=</span><span class="n">Ge_alpha</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">bot_cell_n_material</span><span class="o">.</span><span class="n">hole_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;800nm&quot;</span><span class="p">)</span>
<span class="n">bot_cell_p_material</span><span class="o">.</span><span class="n">electron_minority_carrier_diffusion_length</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="s2">&quot;50um&quot;</span><span class="p">)</span>

<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bot_cell_n_material</span><span class="p">)</span>
<span class="n">all_materials</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bot_cell_p_material</span><span class="p">)</span>

<span class="c1"># We add some other properties to the materials, assumed the same in all cases.</span>
<span class="c1"># If different, we should have added them above.</span>
<span class="k">for</span> <span class="n">mat</span> <span class="ow">in</span> <span class="n">all_materials</span><span class="p">:</span>
    <span class="n">mat</span><span class="o">.</span><span class="n">hole_mobility</span> <span class="o">=</span> <span class="mf">3.4e-3</span>
    <span class="n">mat</span><span class="o">.</span><span class="n">electron_mobility</span> <span class="o">=</span> <span class="mi">5</span><span class="n">e</span><span class="o">-</span><span class="mi">2</span>
    <span class="n">mat</span><span class="o">.</span><span class="n">dielectric_constant</span> <span class="o">=</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">vacuum_permittivity</span>

<span class="c1"># And, finally, we put everything together, adding also the surface recombination velocities.</span>
<span class="n">triplejunction</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Layer</span><span class="p">(</span><span class="n">material</span><span class="o">=</span><span class="n">window_material</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;25nm&quot;</span><span class="p">)),</span>
        <span class="n">Junction</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;100nm&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">top_cell_n_material</span><span class="p">),</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;600nm&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">top_cell_p_material</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="n">sn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">sp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">Junction</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;100nm&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">mid_cell_n_material</span><span class="p">),</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;3.5um&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">mid_cell_p_material</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="n">sn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">sp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
        <span class="n">Junction</span><span class="p">(</span>
            <span class="p">(</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;400nm&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">bot_cell_n_material</span><span class="p">),</span>
                <span class="n">Layer</span><span class="p">(</span><span class="n">si</span><span class="p">(</span><span class="s2">&quot;100um&quot;</span><span class="p">),</span> <span class="n">material</span><span class="o">=</span><span class="n">bot_cell_p_material</span><span class="p">),</span>
            <span class="p">),</span>
            <span class="n">sn</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">sp</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># Now the &#39;solar_cell&#39; object below contains all the information regarding the solar cell. So, we use it</span>
<span class="n">solar_cell</span> <span class="o">=</span> <span class="n">State</span><span class="p">()</span>
<span class="n">solar_cell</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">triplejunction</span>
<span class="n">solar_cell</span><span class="o">.</span><span class="n">reflectivity</span> <span class="o">=</span> <span class="n">refl_J</span>
</pre></div>
</div>
<p>So far, it has been only the definition of the structure. To actually calculate the quantum efficiency we need to add the energy range in which we want to calculate the results and call the <em>spectral_response_all_junctions</em> function:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">solcore.analytic_solar_cells</span> <span class="k">as</span> <span class="nn">ASC</span>

<span class="c1"># The energy in SI units</span>
<span class="n">E</span> <span class="o">=</span> <span class="n">si</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">3.4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">),</span> <span class="s2">&quot;eV&quot;</span><span class="p">)</span>

<span class="c1"># We add this energy to the solar cell structure.</span>
<span class="n">solar_cell</span><span class="o">.</span><span class="n">energies</span> <span class="o">=</span> <span class="n">E</span>

<span class="c1"># We run the simulation. Verbose=True ensures that we have a full report of the parameters printed on the screen</span>
<span class="n">qe_result</span> <span class="o">=</span> <span class="n">ASC</span><span class="o">.</span><span class="n">spectral_response_all_junctions</span><span class="p">(</span><span class="n">solar_cell</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Below there is an image of the QE corresponding to the three junctions as a function of wavelength, which is a more common representation.</p>
<img alt="../_images/qe_mj.png" class="align-center" src="../_images/qe_mj.png" />
<p>Since we didn&#8217;t define any solar spectrum or solar cell geometry, we can not have the short circuit current for each of the junctions. We add that information to the solar_cell object above and sun again the solver. We are assuming we have some concentration optics and metallisation on top of the solar cell:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">solcore.solar_spectrum</span> <span class="k">import</span> <span class="n">calculate_spectrum_spectral2</span>

<span class="c1"># Configure cell geometry and concentration</span>
<span class="c1"># Cell area is stated to be 7mm x 7mm</span>
<span class="n">cell_area</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="mf">0.7</span> <span class="o">/</span> <span class="mi">1</span><span class="n">e4</span>  <span class="c1"># expressed in m-2</span>
<span class="c1"># Geometrical concentration is 1000, but the optical efficiency is approximately 0.85 and cell metalisation shading 8%</span>
<span class="n">concentration_factor</span> <span class="o">=</span> <span class="mi">1000</span> <span class="o">*</span> <span class="mf">0.85</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.08</span><span class="p">)</span>

<span class="c1"># We create a solar spectrum using SPECTRAL2 and the default configuration</span>
<span class="c1"># - See documentation and example of that package for more info</span>
<span class="n">spectrum</span> <span class="o">=</span> <span class="n">calculate_spectrum_spectral2</span><span class="p">()</span>

<span class="c1"># We use the spectrum is in SI units: Watts m-2 joule-1.</span>
<span class="n">incident_x_J_y_per_J</span> <span class="o">=</span> <span class="n">spectrum</span><span class="p">[</span><span class="s2">&quot;incident spectrum energy si&quot;</span><span class="p">]</span>
<span class="n">incident_function</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">incident_x_J_y_per_J</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">concentration_factor</span> <span class="o">*</span> <span class="n">cell_area</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">incident_x_J_y_per_J</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">power_density</span> <span class="o">=</span> <span class="n">spectrum</span><span class="p">[</span><span class="s2">&quot;incident power density&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Power density = </span><span class="si">{:.2f}</span><span class="s1"> W m-2</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">power_density</span><span class="p">))</span>

<span class="c1"># We already have the energies, as defined above</span>
<span class="n">solar_cell</span><span class="o">.</span><span class="n">incident_light</span> <span class="o">=</span> <span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">incident_function</span><span class="p">(</span><span class="n">E</span><span class="p">)</span> <span class="o">/</span> <span class="n">E</span> <span class="p">)</span>
<span class="n">qe_result</span> <span class="o">=</span> <span class="n">ASC</span><span class="o">.</span><span class="n">spectral_response_all_junctions</span><span class="p">(</span><span class="n">solar_cell</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Subcell photocurrent density [mA cm-2]:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Jsc(Top) = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="n">e3</span> <span class="o">*</span> <span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">cell_area</span> <span class="o">*</span> <span class="mi">1</span><span class="n">e4</span> <span class="o">*</span> <span class="n">concentration_factor</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Jsc(Mid) = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="n">e3</span> <span class="o">*</span> <span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">cell_area</span> <span class="o">*</span> <span class="mi">1</span><span class="n">e4</span> <span class="o">*</span> <span class="n">concentration_factor</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Jsc(Bot) = </span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="n">e3</span> <span class="o">*</span> <span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">cell_area</span> <span class="o">*</span> <span class="mi">1</span><span class="n">e4</span> <span class="o">*</span> <span class="n">concentration_factor</span><span class="p">)))</span>
</pre></div>
</div>
<p>After these modifications, the quantum efficiency has not changed, but we can have the short circuit current density of each of the subcells:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Power</span> <span class="n">density</span> <span class="o">=</span> <span class="mf">891.90</span> <span class="n">W</span> <span class="n">m</span><span class="o">-</span><span class="mi">2</span>

<span class="n">Subcell</span> <span class="n">photocurrent</span> <span class="n">density</span> <span class="p">[</span><span class="n">mA</span> <span class="n">cm</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Top</span><span class="p">)</span> <span class="o">=</span> <span class="mf">9.73</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Mid</span><span class="p">)</span> <span class="o">=</span> <span class="mf">12.02</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Bot</span><span class="p">)</span> <span class="o">=</span> <span class="mf">25.18</span>
</pre></div>
</div>
<span class="target" id="module-solcore.analytic_solar_cells.QE"></span><dl class="function">
<dt id="solcore.analytic_solar_cells.QE.spectral_response_all_junctions">
<code class="descclassname">solcore.analytic_solar_cells.QE.</code><code class="descname">spectral_response_all_junctions</code><span class="sig-paren">(</span><em>state_object</em>, <em>V=0</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/QE.html#spectral_response_all_junctions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.QE.spectral_response_all_junctions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the spectral response of any number of junctions using analytical diode equations as described in
J. Nelson&#8217;s book &#8220;The Physics of Solar Cells&#8221; (2003). All parameters must be in SI units. It only works for
homojunctions.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>state_object</strong> &#8211; <p>State object containing all the information necessary to calculate the spectral response of the solar cells. It has to include:</p>
<ul>
<li>structure: A structure object with one or more Junction objects. Each junction is made of a sequence of <em>Layers</em> (with a thickness and a material - which MUST include a role= n, p or i) and the surface recombination velocities for electrons and holes. Window layers and back surface filed layers must be left outside the Junction definition.</li>
<li>incident_light: (optional) 2D array containing the energies and the spectral power density.</li>
<li>energies: (optional) Energies at which to calculate the spectral response. It is ignored if incident_light is provided.</li>
<li>shading: (optional) Shading loses.</li>
<li>reflectivity: (optional) 2D array containing the reflectivity of the solar cell as a function of the energy</li>
<li>reflectivity_function: (optional) function that calculates the reflectivity as a function of energy.</li>
</ul>
</li>
<li><strong>V</strong> &#8211; The voltage at which to perform the calculations (not implemented, yet)</li>
<li><strong>verbose</strong> &#8211; If the information about the calculation must be printed.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>A dictionary containing, as a function of energy:</p>
<ul class="simple">
<li>junctions: A list containing the QE data for each junction</li>
<li>transmitted: The transmitted power density</li>
<li>transmitted_fraction: The fraction of transmitted power</li>
<li>passive_loss: The passive losses (light absorbed in the encapsulants, AR coatings, window layers, etc)</li>
<li>reflected: reflected power density</li>
<li>reflected_fraction: Fraction of reflected power</li>
<li>e: The energy values</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="solcore.analytic_solar_cells.QE.calculate_junction_sr">
<code class="descclassname">solcore.analytic_solar_cells.QE.</code><code class="descname">calculate_junction_sr</code><span class="sig-paren">(</span><em>junc</em>, <em>energies</em>, <em>bs</em>, <em>bsInitial</em>, <em>V</em>, <em>printParameters=False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/QE.html#calculate_junction_sr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.QE.calculate_junction_sr" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the total quantum efficiency, the QE splitted by regions, photocurrent and other parameters for a
given junction at a given voltage.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>junc</strong> &#8211; The junction object</li>
<li><strong>energies</strong> &#8211; The energies at which to perform the calculation</li>
<li><strong>bs</strong> &#8211; The spectral power density reaching the junction</li>
<li><strong>bsInitial</strong> &#8211; The initial power density</li>
<li><strong>V</strong> &#8211; The voltage at which to perform the calculations (not implemented, yet)</li>
<li><strong>printParameters</strong> &#8211; If a list of all parameters must be printed</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="multi-junction-current-voltage-calculator">
<span id="iv-calculator"></span><h2>Multi-junction current voltage calculator<a class="headerlink" href="#multi-junction-current-voltage-calculator" title="Permalink to this headline">¶</a></h2>
<p>This module contanes all the functions necessary to calculate the IV curve of single and multi-junction solar cells using the2-diode equation as the starting point. In addition to the <em>multijunctionIV</em> function that can invoked directly when importing the solcore.analytic_solar_cells package, this module containes several tools to calculate the reverse saturation currents under the radiative aproximation, using a radiative efficiency or based on the knowledge of Voc and Jsc.</p>
<p>Here is an example on how to use this module to calculate the IV curve of a triple junction solar cell, using the results of the Example 3 above (see <a class="reference internal" href="#quantum-efficiency-calculator"><span class="std std-ref">Quantum efficiency calculator</span></a>) and ploting them with the <em>solcore.graphing</em> package:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">solcore.structure</span> <span class="k">import</span> <span class="n">Structure</span><span class="p">,</span> <span class="n">Junction</span>
<span class="kn">import</span> <span class="nn">solcore.analytic_solar_cells</span> <span class="k">as</span> <span class="nn">ASC</span>
<span class="kn">from</span> <span class="nn">solcore.state</span> <span class="k">import</span> <span class="n">State</span>
<span class="kn">from</span> <span class="nn">solcore.graphing</span> <span class="k">import</span> <span class="o">*</span>

<span class="c1"># We import the QE results obtained in ASC_example_3 which contain the short circuit currents of each junction</span>
<span class="c1"># when the solar cell is illuminated with the default SPECTAL2 spectrum</span>
<span class="kn">from</span> <span class="nn">ASC_example_3</span> <span class="k">import</span> <span class="n">qe_result</span><span class="p">,</span> <span class="n">power_density</span><span class="p">,</span> <span class="n">cell_area</span><span class="p">,</span> <span class="n">concentration_factor</span>

<span class="c1"># Ref temperature ºC. Let&#39;s say we have the reverse saturation currents J01 and J02 of each junction at a</span>
<span class="c1"># reference temperature and we want the IV curve at a different one. We have to make a correction to the J01 and J02</span>
<span class="n">cell_temp</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">ref_temp</span> <span class="o">=</span> <span class="mi">25</span>

<span class="n">Tcell</span> <span class="o">=</span> <span class="mi">273</span> <span class="o">+</span> <span class="n">cell_temp</span>
<span class="n">Tref</span> <span class="o">=</span> <span class="mi">273</span> <span class="o">+</span> <span class="n">ref_temp</span>

<span class="c1"># The IV data will be stored in a State object. We create it, including the cell and reference temperatures.</span>
<span class="n">IV_calculation_state</span> <span class="o">=</span> <span class="n">State</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Tcell</span><span class="p">,</span> <span class="n">Tref</span><span class="o">=</span><span class="n">Tref</span><span class="p">)</span>

<span class="c1"># From the QE object we get the short circuit currents</span>
<span class="n">Isc_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">],</span> <span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">],</span> <span class="n">qe_result</span><span class="p">[</span><span class="s2">&quot;junctions&quot;</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="s2">&quot;J&quot;</span><span class="p">]]</span>

<span class="c1"># And we create a list with the reverse saturation currents. In this case, we don&#39;t calculate them but just assume we</span>
<span class="c1"># have them from somewhere.</span>
<span class="n">I01_array</span> <span class="o">=</span> <span class="p">[</span><span class="mf">4.93e-24</span><span class="p">,</span> <span class="mf">1.0e-21</span><span class="p">,</span> <span class="mf">4.93e-6</span><span class="p">]</span>
<span class="n">I02_array</span> <span class="o">=</span> <span class="p">[</span><span class="mf">3.28e-15</span><span class="p">,</span> <span class="mf">2.7e-10</span><span class="p">,</span> <span class="mf">1.0e-5</span><span class="p">]</span>

<span class="c1"># This is the structure to calculate.</span>
<span class="n">IV_calculation_state</span><span class="o">.</span><span class="n">structure</span> <span class="o">=</span> <span class="n">Structure</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">Junction</span><span class="p">(</span><span class="n">Eg</span><span class="o">=</span><span class="mf">1.9</span><span class="p">,</span> <span class="n">j01</span><span class="o">=</span><span class="n">I01_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">j02</span><span class="o">=</span><span class="n">I02_array</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">R_shunt</span><span class="o">=</span><span class="mi">3</span><span class="n">e6</span><span class="p">,</span>
                 <span class="n">R_series</span><span class="o">=</span><span class="mf">0.0236</span><span class="p">,</span> <span class="n">n1</span><span class="o">=</span><span class="mf">1.00</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">photocurrent</span><span class="o">=</span><span class="n">Isc_array</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span>
        <span class="n">Junction</span><span class="p">(</span><span class="n">Eg</span><span class="o">=</span><span class="mf">1.4</span><span class="p">,</span> <span class="n">j01</span><span class="o">=</span><span class="n">I01_array</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">j02</span><span class="o">=</span><span class="n">I02_array</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">R_shunt</span><span class="o">=</span><span class="mf">1.5e6</span><span class="p">,</span>
                 <span class="n">R_series</span><span class="o">=</span><span class="mf">0.0012</span><span class="p">,</span> <span class="n">n1</span><span class="o">=</span><span class="mf">1.00</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">photocurrent</span><span class="o">=</span><span class="n">Isc_array</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span>
        <span class="n">Junction</span><span class="p">(</span><span class="n">Eg</span><span class="o">=</span><span class="mf">0.66</span><span class="p">,</span> <span class="n">j01</span><span class="o">=</span><span class="n">I01_array</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">j02</span><span class="o">=</span><span class="n">I02_array</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">R_shunt</span><span class="o">=</span><span class="mi">115</span><span class="p">,</span>
                 <span class="n">R_series</span><span class="o">=</span><span class="mi">8</span><span class="n">e</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">n1</span><span class="o">=</span><span class="mf">1.00</span><span class="p">,</span> <span class="n">n2</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">photocurrent</span><span class="o">=</span><span class="n">Isc_array</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
    <span class="p">]</span>
<span class="p">)</span>

<span class="c1"># We solve it, including explicitely the range of voltages we are interested</span>
<span class="n">IV_result</span> <span class="o">=</span> <span class="n">ASC</span><span class="o">.</span><span class="n">multijunctionIV</span><span class="p">(</span><span class="n">IV_calculation_state</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>

<span class="c1"># We use the tools of the graphing package to get a nice plot of the IV curves.</span>
<span class="n">junction_colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;red&quot;</span><span class="p">]</span>
<span class="n">graph_lines</span> <span class="o">=</span> <span class="p">[</span><span class="n">GraphData</span><span class="p">(</span><span class="n">iv</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Junction </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="n">junction_colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
               <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">iv</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;junction IV&quot;</span><span class="p">])]</span>
<span class="n">graph_lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GraphData</span><span class="p">(</span><span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;IV&quot;</span><span class="p">],</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Multijunction&quot;</span><span class="p">))</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">graph_lines</span><span class="p">,</span> <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">xlabel</span><span class="o">=</span><span class="s2">&quot;Bias (V)&quot;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s2">&quot;Current (A)&quot;</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>

<span class="n">eta</span> <span class="o">=</span> <span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;Pmpp&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">power_density</span> <span class="o">*</span> <span class="n">cell_area</span> <span class="o">*</span> <span class="n">concentration_factor</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">The solar cell properties are: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Isc = </span><span class="si">{:.2f}</span><span class="s1"> mA cm-2&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">1</span><span class="n">e3</span> <span class="o">*</span> <span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;Isc&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">cell_area</span> <span class="o">*</span> <span class="mi">1</span><span class="n">e4</span> <span class="o">*</span> <span class="n">concentration_factor</span><span class="p">)</span> <span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Voc = </span><span class="si">{:.2f}</span><span class="s1"> V&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;Voc&quot;</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">FF = </span><span class="si">{:.2f}</span><span class="s1"> % &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">IV_result</span><span class="p">[</span><span class="s2">&quot;FF&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">Eta = </span><span class="si">{:.2f}</span><span class="s1"> %&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">eta</span> <span class="o">*</span> <span class="mi">100</span><span class="p">))</span>
</pre></div>
</div>
<p>The result of the above coe will be the figure below and the following output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Power</span> <span class="n">density</span> <span class="o">=</span> <span class="mf">891.90</span> <span class="n">W</span> <span class="n">m</span><span class="o">-</span><span class="mi">2</span>

<span class="n">Subcell</span> <span class="n">photocurrent</span> <span class="n">density</span> <span class="p">[</span><span class="n">mA</span> <span class="n">cm</span><span class="o">-</span><span class="mi">2</span><span class="p">]:</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Top</span><span class="p">)</span> <span class="o">=</span> <span class="mf">9.73</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Mid</span><span class="p">)</span> <span class="o">=</span> <span class="mf">12.02</span>
    <span class="n">Jsc</span><span class="p">(</span><span class="n">Bot</span><span class="p">)</span> <span class="o">=</span> <span class="mf">25.18</span>

<span class="n">The</span> <span class="n">solar</span> <span class="n">cell</span> <span class="n">properties</span> <span class="n">are</span><span class="p">:</span>
    <span class="n">Isc</span> <span class="o">=</span> <span class="mf">9.73</span> <span class="n">mA</span> <span class="n">cm</span><span class="o">-</span><span class="mi">2</span>
    <span class="n">Voc</span> <span class="o">=</span> <span class="mf">3.34</span> <span class="n">V</span>
    <span class="n">FF</span> <span class="o">=</span> <span class="mf">89.20</span> <span class="o">%</span>
    <span class="n">Eta</span> <span class="o">=</span> <span class="mf">32.51</span> <span class="o">%</span>
</pre></div>
</div>
<img alt="../_images/iv_mj.png" class="align-center" src="../_images/iv_mj.png" />
<span class="target" id="module-solcore.analytic_solar_cells.IV"></span><dl class="function">
<dt id="solcore.analytic_solar_cells.IV.multijunctionIV">
<code class="descclassname">solcore.analytic_solar_cells.IV.</code><code class="descname">multijunctionIV</code><span class="sig-paren">(</span><em>state_object</em>, <em>V=None</em>, <em>photon_recycling=False</em>, <em>n1=1</em>, <em>n2=2</em>, <em>fraction_coupled=None</em>, <em>coupling_iterations=10</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/IV.html#multijunctionIV"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.IV.multijunctionIV" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the overall IV characteristics of any number of junctions numerically at the requested voltage
points. If photocurrent_np is not provided, the resultant IV characteristics are purely recombination currents,
otherwise light IVs are returned.</p>
<p>If the state_object includes a reference temperature &#8220;Tref&#8221;, then the reverse saturation currents are assumed to be
at that temperature and are therefore re-calculated at the target &#8220;T&#8221;. This is only valid for small temperature
differences.</p>
<dl class="docutils">
<dt>Conventions followed:</dt>
<dd><ul class="first last simple">
<li>SI Units</li>
<li>Photocurrents: Positive.</li>
<li>Dark Currents: Negative</li>
</ul>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>state_object</strong> &#8211; <p>State object containing</p>
<ul>
<li>T: overall temperature</li>
<li>Tref: (optional, in case the j01 and j02 correspond to a different temperature that the target temperature)</li>
<li>structure: Structure object containing one or more Junction objects, each with (at least) the following</li>
</ul>
<p>parameters in SI units:</p>
<blockquote>
<div><ul>
<li>j01</li>
<li>j02</li>
<li>n1</li>
<li>n2</li>
<li>R_series</li>
<li>R_shunt</li>
<li>photocurrent (optional, is assumed = 0 if not present)</li>
<li>Eg (optional, bandgap, only used if Tref is given)</li>
<li>material (optional, a solcore.material object, needed for radiative coupling calculations)</li>
<li>qe (optional, the quantum efficiency of the junction, needed for radiative coupling calculations)</li>
<li>e (optional, the energy of the qe, needed for radiative coupling calculations)</li>
</ul>
</div></blockquote>
</li>
<li><strong>photon_recycling</strong> &#8211; If photon recycling calculation must be included (NOT IMPLEMENTED YET)</li>
<li><strong>V</strong> &#8211; Voltages at which to have the resulting IV curve</li>
<li><strong>n1</strong> &#8211; Default n1 ideality factor (=1) if not included in the Junction objects</li>
<li><strong>n2</strong> &#8211; Default n2 ideality factor (=2) if not included in the Junction objects</li>
<li><strong>fraction_coupled</strong> &#8211; fraction of the emitted light coupled from one junction to the next</li>
<li><strong>coupling_iterations</strong> &#8211; the maximum number of iterations during the coupling calculation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><p>state object, updated to include:</p>
<ul class="simple">
<li>&#8220;IV&#8221;: (V, I) Calculated IV characteristics</li>
<li>&#8220;junction IV&#8221;: [(V junc 1, I junc 1), (V junc 2, I junc 2), ...]</li>
<li>&#8220;Rseries IV&#8221;: (V, I) Calculated IV characteristics of the series resistance</li>
<li>&#8220;V&#8221;: Device voltages</li>
<li>&#8220;I&#8221;: Device currents (the same for all junctions).</li>
<li>&#8220;Isc&#8221;, Voc&#8221;, &#8220;P&#8221; and &#8220;FF&#8221;: In case of calculation under illumination.</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="solcore.analytic_solar_cells.IV.simple_gp">
<code class="descclassname">solcore.analytic_solar_cells.IV.</code><code class="descname">simple_gp</code><span class="sig-paren">(</span><em>e</em>, <em>n</em>, <em>T</em>, <em>V</em>, <em>absorption</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/IV.html#simple_gp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.IV.simple_gp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="solcore.analytic_solar_cells.IV.calculate_J01">
<code class="descclassname">solcore.analytic_solar_cells.IV.</code><code class="descname">calculate_J01</code><span class="sig-paren">(</span><em>Eg_in_eV</em>, <em>T</em>, <em>n</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/IV.html#calculate_J01"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.IV.calculate_J01" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the reverse saturation current J01, assumed radiative, considering an absorption equal to 1 above the
bandgap. Light trapping is included by considering the refractive index of the material:</p>
<div class="math">
<p><img src="../_images/math/3e7a7d29d9918aee38b86979b6fcd380c33a64ec.png" alt="J_{01} = \frac {q n^2 k_b T} {2 \pi ^2 c^2 \hbar ^3} e^{\frac{-E_g}{k_b T}} (E_g^2 + 2 k_b T E_g + 2 k_b^2 T^2)"/></p>
</div><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>Eg_in_eV</strong> &#8211; Bandgap  in eV</li>
<li><strong>T</strong> &#8211; Cell temperature</li>
<li><strong>n</strong> &#8211; Refractive index of the material</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The reverse saturation current J01</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="solcore.analytic_solar_cells.IV.calculate_J02_from_Voc">
<code class="descclassname">solcore.analytic_solar_cells.IV.</code><code class="descname">calculate_J02_from_Voc</code><span class="sig-paren">(</span><em>J01</em>, <em>Jsc</em>, <em>Voc</em>, <em>T</em>, <em>R_shunt=1000000000000000.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/IV.html#calculate_J02_from_Voc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.IV.calculate_J02_from_Voc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates J02 based on the J01, Jsc and the Voc. It is just the result of solving the 2-diode equation for J02.
Ideality factors n1 and n2 are assumed to be equal to 1 and 2, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>J01</strong> &#8211; Reverse saturation current J01, typically the radiative component</li>
<li><strong>Jsc</strong> &#8211; Short circuit current (=photocurrent)</li>
<li><strong>Voc</strong> &#8211; Open circuit voltage</li>
<li><strong>T</strong> &#8211; Temperature</li>
<li><strong>R_shunt</strong> &#8211; Shunt resistance (default = 1e15)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The reverse saturation current J02</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="solcore.analytic_solar_cells.IV.calculate_J02_from_rad_eff">
<code class="descclassname">solcore.analytic_solar_cells.IV.</code><code class="descname">calculate_J02_from_rad_eff</code><span class="sig-paren">(</span><em>J01</em>, <em>radiative_efficiency</em>, <em>V</em>, <em>T</em>, <em>R_shunt=1000000000000000.0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/IV.html#calculate_J02_from_rad_eff"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.IV.calculate_J02_from_rad_eff" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates J02 based on J01 and a radiative efficiency at a given voltage and temperature. Ideality factors n1
and n2 are assumed to be equal to 1 and 2, respectively.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>J01</strong> &#8211; Reverse saturation current J01, typically the radiative component</li>
<li><strong>radiative_efficiency</strong> &#8211; Fraction of the dark current that is radiative</li>
<li><strong>V</strong> &#8211; Operating voltage</li>
<li><strong>T</strong> &#8211; Temperature</li>
<li><strong>R_shunt</strong> &#8211; Shunt resistance (default = 1e15)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="solcore.analytic_solar_cells.IV.update_j0">
<code class="descclassname">solcore.analytic_solar_cells.IV.</code><code class="descname">update_j0</code><span class="sig-paren">(</span><em>junctions</em>, <em>T</em>, <em>Tref</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/solcore/analytic_solar_cells/IV.html#update_j0"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#solcore.analytic_solar_cells.IV.update_j0" title="Permalink to this definition">¶</a></dt>
<dd><p>Updates the reverse saturation currents for the target temperature knowing their values at a reference
temperature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>junctions</strong> &#8211; List of junctions</li>
<li><strong>T</strong> &#8211; Target temperature</li>
<li><strong>Tref</strong> &#8211; Working temperature</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">List of junctions with their saturation currents updated for the new temperatures</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Analytic solar cells calculator</a><ul>
<li><a class="reference internal" href="#quantum-efficiency-calculator">Quantum efficiency calculator</a></li>
<li><a class="reference internal" href="#multi-junction-current-voltage-calculator">Multi-junction current voltage calculator</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="../spectral/spectral.html"
                        title="previous chapter">Spectral irradiance model and database</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../PDD/DDsolver.html"
                        title="next chapter">Poisson - Drift-Diffusion solver (PDD)</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/ASC/ASC.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="../PDD/DDsolver.html" title="Poisson - Drift-Diffusion solver (PDD)"
             >next</a> |</li>
        <li class="right" >
          <a href="../spectral/spectral.html" title="Spectral irradiance model and database"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Solcore 4.1.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2016, Quantum Photovoltaics Group, Imperial College London.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.1.
    </div>
  </body>
</html>