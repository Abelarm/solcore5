
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>solcore.light_source.light_source &#8212; Solcore 5.2.0.dev.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '5.2.0.dev.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Solcore 5.2.0.dev.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/header2.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Installation/installation.html">Installation and configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Structures/structure.html">Structures and support classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Systems/systems.html">Materials and units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../QM/Schrodinger.html">Quantum Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../spectral/spectral.html">Light Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Optics/optics.html">Optical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Solvers/solving_solar_cells.html">Solar cell solvers</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for solcore.light_source.light_source</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="k">import</span> <span class="n">interp1d</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">solcore.science_tracker</span> <span class="k">import</span> <span class="n">science_reference</span>
<span class="kn">from</span> <span class="nn">solcore</span> <span class="k">import</span> <span class="n">spectral_conversion_nm_ev</span><span class="p">,</span> <span class="n">spectral_conversion_nm_hz</span><span class="p">,</span> <span class="n">eVnm</span><span class="p">,</span> <span class="n">nmHz</span><span class="p">,</span> <span class="n">nmJ</span>
<span class="kn">from</span> <span class="nn">solcore.constants</span> <span class="k">import</span> <span class="n">q</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">kb</span>

<span class="kn">from</span> <span class="nn">solcore.light_source.spectral2</span> <span class="k">import</span> <span class="n">get_default_spectral2_object</span><span class="p">,</span> <span class="n">calculate_spectrum_spectral2</span>
<span class="kn">from</span> <span class="nn">solcore.light_source.smarts</span> <span class="k">import</span> <span class="n">get_default_smarts_object</span><span class="p">,</span> <span class="n">calculate_spectrum_smarts</span>


<div class="viewcode-block" id="reference_spectra"><a class="viewcode-back" href="../../../spectral/spectral.html#solcore.light_source.light_source.reference_spectra">[docs]</a><span class="k">def</span> <span class="nf">reference_spectra</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Function providing the standard reference spectra: AM0, AM1.5g and AM1.5d.</span>

<span class="sd">    :return: A 2D array with 4 columns representing the wavelength, AM0, AM1.5g and AM1.5d standard spectra.&quot;&quot;&quot;</span>

    <span class="n">science_reference</span><span class="p">(</span><span class="s2">&quot;Standard solar spectra&quot;</span><span class="p">,</span>
                      <span class="s2">&quot;ASTM G173-03(2012), Standard Tables for Reference Solar Spectral Irradiances: &quot;</span>
                      <span class="s2">&quot;Direct Normal and Hemispherical on 37Â° Tilted Surface, ASTM International, &quot;</span>
                      <span class="s2">&quot;West Conshohocken, PA, 2012, www.astm.org&quot;</span><span class="p">)</span>

    <span class="n">this_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_dir</span><span class="p">,</span> <span class="s2">&quot;astmg173.csv&quot;</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">skiprows</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">output</span></div>


<div class="viewcode-block" id="LightSource"><a class="viewcode-back" href="../../../spectral/spectral.html#solcore.light_source.light_source.LightSource">[docs]</a><span class="k">class</span> <span class="nc">LightSource</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; This is a common interface to access all types of light sources supported by Solcore: standard solar spectra (AM0, AM1.5g, and AM1.5d), blackbody radiation, laser light or spectra created from atmospheric data using SPECTRAL2 or SMARTS. Aditionally, it can also use experimentally measured spectra.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">type_of_source</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;laser&#39;</span><span class="p">,</span> <span class="s1">&#39;black body&#39;</span><span class="p">,</span> <span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="s1">&#39;SMARTS&#39;</span><span class="p">,</span> <span class="s1">&#39;SPECTRAL2&#39;</span><span class="p">,</span> <span class="s1">&#39;custom&#39;</span><span class="p">]</span>
    <span class="n">output_units</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;power_density_per_eV&#39;</span><span class="p">,</span> <span class="s1">&#39;power_density_per_nm&#39;</span><span class="p">,</span> <span class="s1">&#39;power_density_per_J&#39;</span><span class="p">,</span> <span class="s1">&#39;power_density_per_m&#39;</span>
                                                                                           <span class="s1">&#39;photon_flux_per_eV&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;photon_flux_per_nm&#39;</span><span class="p">,</span> <span class="s1">&#39;photon_flux_per_J&#39;</span><span class="p">,</span> <span class="s1">&#39;power_density_per_hz&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;photon_flux_per_hz&#39;</span><span class="p">,</span> <span class="s1">&#39;photon_flux_per_m&#39;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">source_type</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        :param source_type:</span>
<span class="sd">        :param kwargs:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source_type</span> <span class="o">=</span> <span class="n">source_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">power_density</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;output_units&#39;</span><span class="p">:</span> <span class="s1">&#39;power_density_per_nm&#39;</span><span class="p">,</span> <span class="s1">&#39;concentration&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_update_get_spectrum</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_update_spectrum_function</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ready</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_spectrum</span> <span class="o">=</span> <span class="kc">None</span>

<div class="viewcode-block" id="LightSource.spectrum"><a class="viewcode-back" href="../../../spectral/spectral.html#solcore.light_source.light_source.LightSource.spectrum">[docs]</a>    <span class="k">def</span> <span class="nf">spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Returns the spectrum of the light in the requested units. Internally, the spectrum is always managed in power density per nanometers, but the output can be provided in other compatible units, such as power density per Hertz or photon flux per eV.</span>

<span class="sd">        :param x: (Default=None) If &quot;x&quot; is provided, it must be an array with the spectral range in which to calculate the spectrum. Depending on the &quot;units&quot; defined when creating the light source, this array must be in nm, m, eV, J or hz.</span>
<span class="sd">        :param kwargs: Options to update the light source. It can be &quot;units&quot;, &quot;concentration&quot; or any of the options specific to the chosen type of light source.</span>
<span class="sd">        :return: Array with the spectrum in the requested units</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ready</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_spectrum_function</span><span class="p">()</span>
                <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cache_spectrum</span> <span class="o">=</span> <span class="n">output</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">ready</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_update_spectrum_function</span><span class="p">()</span>
                <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">cache_spectrum</span> <span class="o">=</span> <span class="n">output</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache_spectrum</span>

            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">output</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>

        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR: No stored spectrum or &quot;x&quot; data not available.&#39;</span>
                  <span class="s1">&#39;You must call the &quot;spectrum&quot; function at least once with a value for the &quot;x&quot; argument.&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Updates the options of the light source with new values. It only updates existing options. No new options are added.</span>

<span class="sd">        :param kwargs: A dictionary with the options to update and their new values.</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">opt</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span>

        <span class="k">if</span> <span class="s1">&#39;output_units&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_update_get_spectrum</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">ready</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache_spectrum</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_update_get_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Updates the function to get the spectrum, depending on the chosen output units.</span>

<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;output_units&#39;</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;power_density_per_nm&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_power_density_per_nm</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;power_density_per_m&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_power_density_per_m</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;photon_flux_per_nm&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_photon_flux_per_nm</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;photon_flux_per_m&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_photon_flux_per_m</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;power_density_per_eV&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_power_density_per_eV</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;photon_flux_per_eV&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_photon_flux_per_eV</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;power_density_per_J&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_power_density_per_J</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;photon_flux_per_J&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_photon_flux_per_J</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;power_density_per_hz&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_power_density_per_hz</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;photon_flux_per_hz&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_photon_flux_per_hz</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown units: </span><span class="si">{0}</span><span class="s1">.</span><span class="se">\n</span><span class="s1">Valid units are: </span><span class="si">{1}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_units</span><span class="p">))</span>

        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_power_density_per_nm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function that returns the spectrum in power density per nanometer.</span>

<span class="sd">        :param wavelength: Array with the wavelengths at which to calculate the spectrum (in nm)</span>
<span class="sd">        :return: The spectrum in the chosen units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_get_photon_flux_per_nm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function that returns the spectrum in photon flux per nanometer.</span>

<span class="sd">        :param wavelength: Array with the wavelengths at which to calculate the spectrum (in nm)</span>
<span class="sd">        :return: The spectrum in the chosen units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="mf">1e+9</span> <span class="o">/</span> <span class="n">wavelength</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_get_power_density_per_m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function that returns the spectrum in power density per meter.</span>

<span class="sd">        :param wavelength: Array with the wavelengths at which to calculate the spectrum (in m)</span>
<span class="sd">        :return: The spectrum in the chosen units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span><span class="p">(</span><span class="n">wavelength</span><span class="o">*</span><span class="mf">1e-9</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e9</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_get_photon_flux_per_m</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">wavelength</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function that returns the spectrum in photon flux per meter.</span>

<span class="sd">        :param wavelength: Array with the wavelengths at which to calculate the spectrum (in m)</span>
<span class="sd">        :return: The spectrum in the chosen units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span><span class="p">(</span><span class="n">wavelength</span><span class="o">*</span><span class="mf">1e9</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">h</span> <span class="o">/</span> <span class="n">wavelength</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e9</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_get_power_density_per_eV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function that returns the spectrum in power density per eV.</span>

<span class="sd">        :param energy: Array with the energies at which to calculate the spectrum (in eV)</span>
<span class="sd">        :return: The spectrum in the chosen units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wavelength</span> <span class="o">=</span> <span class="n">eVnm</span><span class="p">(</span><span class="n">energy</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">energy_eV</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_ev</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_get_photon_flux_per_eV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function that returns the spectrum in photon flux per eV.</span>

<span class="sd">        :param energy: Array with the energies at which to calculate the spectrum (in eV)</span>
<span class="sd">        :return: The spectrum in the chosen units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wavelength</span> <span class="o">=</span> <span class="n">eVnm</span><span class="p">(</span><span class="n">energy</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">energy_eV</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_ev</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span> <span class="o">/</span> <span class="p">(</span><span class="n">q</span> <span class="o">*</span> <span class="n">energy</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_get_power_density_per_J</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function that returns the spectrum in power density per Joule.</span>

<span class="sd">        :param energy: Array with the energies at which to calculate the spectrum (in J)</span>
<span class="sd">        :return: The spectrum in the chosen units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wavelength</span> <span class="o">=</span> <span class="n">nmJ</span><span class="p">(</span><span class="n">energy</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">energy_eV</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_ev</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span> <span class="o">/</span> <span class="n">q</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_get_photon_flux_per_J</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">energy</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function that returns the spectrum in photon flux per Joule.</span>

<span class="sd">        :param energy: Array with the energies at which to calculate the spectrum (in J)</span>
<span class="sd">        :return: The spectrum in the chosen units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wavelength</span> <span class="o">=</span> <span class="n">nmJ</span><span class="p">(</span><span class="n">energy</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">energy_eV</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_ev</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span> <span class="o">/</span> <span class="p">(</span><span class="n">q</span> <span class="o">*</span> <span class="n">energy</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_get_power_density_per_hz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function that returns the spectrum in power density per hertz.</span>

<span class="sd">        :param frequency: Array with the frequencies at which to calculate the spectrum (in hz)</span>
<span class="sd">        :return: The spectrum in the chosen units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wavelength</span> <span class="o">=</span> <span class="n">nmHz</span><span class="p">(</span><span class="n">frequency</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">frequency</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_hz</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_get_photon_flux_per_hz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frequency</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Function that returns the spectrum in photon flux per hertz.</span>

<span class="sd">        :param frequency: Array with the frequencies at which to calculate the spectrum (in hz)</span>
<span class="sd">        :return: The spectrum in the chosen units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">wavelength</span> <span class="o">=</span> <span class="n">nmHz</span><span class="p">(</span><span class="n">frequency</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">output</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span><span class="p">(</span><span class="n">wavelength</span><span class="p">)</span>
        <span class="n">frequency</span><span class="p">,</span> <span class="n">output</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_hz</span><span class="p">(</span><span class="n">wavelength</span><span class="p">,</span> <span class="n">output</span><span class="p">)</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">output</span> <span class="o">/</span> <span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="n">frequency</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_update_spectrum_function</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Updates the spectrum function during the light source creation or just after updating one or more of the options. It also updates the &quot;options&quot; property with any default options available to the chosen light source, if any.</span>

<span class="sd">        :return: True</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_type</span> <span class="o">==</span> <span class="s1">&#39;standard&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_standard_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_type</span> <span class="o">==</span> <span class="s1">&#39;laser&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_laser_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_type</span> <span class="o">==</span> <span class="s1">&#39;black body&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_blackbody_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_type</span> <span class="o">==</span> <span class="s1">&#39;SPECTRAL2&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_spectral2_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_type</span> <span class="o">==</span> <span class="s1">&#39;SMARTS&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_smarts_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">source_type</span> <span class="o">==</span> <span class="s1">&#39;custom&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_spectrum</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_custom_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown type of light source: </span><span class="si">{0}</span><span class="s1">.</span><span class="se">\n</span><span class="s1">Valid light sources are: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">source_type</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">type_of_source</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">ready</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_standard_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Gets one of the reference standard spectra: AM0, AM1.5g or AM1.5d.</span>

<span class="sd">        :param options: A dictionary that contains the &#39;version&#39; of the standard spectrum: &#39;AM0&#39;, &#39;AM1.5g&#39; or &#39;AM1.5d&#39;</span>
<span class="sd">        :return: A function that takes as input the wavelengths and return the standard spectrum at those wavelengths.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">version</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;version&#39;</span><span class="p">]</span>

            <span class="n">spectra</span> <span class="o">=</span> <span class="n">reference_spectra</span><span class="p">()</span>
            <span class="n">wl</span> <span class="o">=</span> <span class="n">spectra</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>

            <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;AM0&#39;</span><span class="p">:</span>
                <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectra</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;AM1.5g&#39;</span><span class="p">:</span>
                <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectra</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">version</span> <span class="o">==</span> <span class="s1">&#39;AM1.5d&#39;</span><span class="p">:</span>
                <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectra</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;ERROR when creating a standard light source. Input parameters must include &quot;version&quot; &#39;</span>
                               <span class="s1">&#39;which can be equal to &quot;AM0&quot;, &quot;AM1.5g&quot; or &quot;AM1.5d&quot; only.&#39;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">power_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">wl</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">wl</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">assume_sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">output</span>

        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_laser_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Creates a gaussian light source with a given total power, linewidth and central wavelength. These three parameters must be provided in the &quot;options&quot; diccionary.</span>

<span class="sd">        :param options: A dictionary that must contain the &#39;power&#39;, the &#39;linewidth&#39; and the &#39;center&#39; of the laser emission.</span>
<span class="sd">        :return: A function that takes as input the wavelengths and return the laser spectrum at those wavelengths.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">power</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;power&#39;</span><span class="p">]</span>
            <span class="n">sigma2</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;linewidth&#39;</span><span class="p">]</span> <span class="o">**</span> <span class="mi">2</span>
            <span class="n">center</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;center&#39;</span><span class="p">]</span>

            <span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="n">out</span> <span class="o">=</span> <span class="n">power</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">sigma2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">sigma2</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">out</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">power_density</span> <span class="o">=</span> <span class="n">power</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">output</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR when creating a laser light source. Input parameters must include &quot;power&quot;, &quot;linewidth&quot;&#39;</span>
                  <span class="s1">&#39; and &quot;center&quot;.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_blackbody_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Gets the expontaneous emission in W/m2/sr/nm from a black body source chemical potential = 0</span>

<span class="sd">        :param options: A dictionary that must contain the temperature of the blackbody, in kelvin &#39;T&#39; and the &#39;entendue&#39; in sr. If not provided, the entendue will be taken as 1 sr. Possible values for entendue are:</span>
<span class="sd">            - &#39;Sun&#39;: The entendue will be taken as 6.8e-5 sr.</span>
<span class="sd">            - &#39;hemispheric&#39;: The entendue wil be taken as pi/2 sr.</span>
<span class="sd">            - A numeric value</span>
<span class="sd">        :return: A function that takes as input the wavelengths and return the black body spectrum at those wavelengths.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">T</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;T&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;entendue&#39;</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;entendue&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Sun&#39;</span><span class="p">:</span>
                    <span class="n">entendue</span> <span class="o">=</span> <span class="mf">6.8e-5</span>
                <span class="k">elif</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;entendue&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;hemispheric&#39;</span><span class="p">:</span>
                    <span class="n">entendue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">entendue</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;entendue&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">entendue</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="n">options</span><span class="p">[</span><span class="s1">&#39;entendue&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

            <span class="k">def</span> <span class="nf">BB</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">1e-9</span>
                <span class="n">out</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">entendue</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="n">c</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">5</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="n">c</span> <span class="o">/</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">kb</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">out</span> <span class="o">*</span> <span class="mf">1e-9</span>

            <span class="n">sigma</span> <span class="o">=</span> <span class="mf">5.670367e-8</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">power_density</span> <span class="o">=</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">T</span> <span class="o">**</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">entendue</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">BB</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR when creating a blackbody light source. Input parameters must include &quot;T&quot; and, &#39;</span>
                  <span class="s1">&#39;optionally, an &quot;entendue&quot;, whose values can be &quot;Sun&quot; &quot;hemispheric&quot; or a number. &#39;</span>
                  <span class="s1">&#39;Equal to 1 if omitted.&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_spectral2_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the solar spectrum calculated with the SPECTRAL2 calculator. The options dictionary is updated with the default options of all parameters if they are not provided.</span>

<span class="sd">        :param options: A dictionary that contain all the options for the calculator.</span>
<span class="sd">        :return: A function that takes as input the wavelengths and return the SPECTRAL2 calculated spectrum at those wavelengths.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">default</span> <span class="o">=</span> <span class="n">get_default_spectral2_object</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">default</span><span class="p">:</span>
                <span class="n">default</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span>

        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

        <span class="n">wl</span><span class="p">,</span> <span class="n">irradiance</span> <span class="o">=</span> <span class="n">calculate_spectrum_spectral2</span><span class="p">(</span><span class="n">options</span><span class="p">,</span> <span class="n">power_density_in_nm</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">power_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">irradiance</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">wl</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">wl</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">irradiance</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">assume_sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">_get_smarts_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Get the solar spectrum calculated with the SMARTS calculator. The options dictionary is updated with the default options of all parameters if they are not provided.</span>

<span class="sd">        :param options: A dictionary that contain all the options for the calculator.</span>
<span class="sd">        :return: A function that takes as input the wavelengths and return the SMARTS calculated spectrum at those wavelengths.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Extraterrestial&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;True direct&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;Experimental direct&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;Global horizontal&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
                   <span class="s1">&#39;Global tilted&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">}</span>

        <span class="n">default</span> <span class="o">=</span> <span class="n">get_default_smarts_object</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">opt</span> <span class="ow">in</span> <span class="n">default</span><span class="p">:</span>
                <span class="n">default</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="n">opt</span><span class="p">]</span>

        <span class="n">options</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>

        <span class="k">if</span> <span class="s1">&#39;output&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">options</span><span class="p">:</span>
            <span class="n">options</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Global horizontal&#39;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">outputs</span><span class="p">[</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;output&#39;</span><span class="p">]]</span>

            <span class="n">out</span> <span class="o">=</span> <span class="n">calculate_spectrum_smarts</span><span class="p">(</span><span class="n">options</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">power_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">out</span><span class="p">[</span><span class="n">output</span><span class="p">],</span> <span class="n">x</span><span class="o">=</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">out</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">out</span><span class="p">[</span><span class="n">output</span><span class="p">],</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">assume_sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">output</span>

        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR: Output option no recognized. Avaliable options are: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">outputs</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">RuntimeError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ERROR in SMARTS: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">err</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_get_custom_spectrum</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">options</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Convert an custom spectrum into a solcore light source object.</span>

<span class="sd">        :param options: A dictionary that contains the following information:</span>
<span class="sd">            - &#39;x_data&#39; and &#39;y_data&#39; of the custom spectrum.</span>
<span class="sd">            - &#39;input_units&#39;, the units of the spectrum, such as &#39;photon_flux_per_nm&#39; or &#39;power_density_per_eV&#39;</span>
<span class="sd">        :return: A function that takes as input the wavelengths and return the custom spectrum at those wavelengths.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">x_data</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;x_data&#39;</span><span class="p">]</span>
            <span class="n">y_data</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;y_data&#39;</span><span class="p">]</span>
            <span class="n">units</span> <span class="o">=</span> <span class="n">options</span><span class="p">[</span><span class="s1">&#39;input_units&#39;</span><span class="p">]</span>

            <span class="c1"># We check the units type by type.</span>
            <span class="c1"># Regardless of the input, we want power_density_per_nm</span>
            <span class="k">if</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;power_density_per_nm&#39;</span><span class="p">:</span>
                <span class="n">wl</span> <span class="o">=</span> <span class="n">x_data</span>
                <span class="n">spectrum</span> <span class="o">=</span> <span class="n">y_data</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;photon_flux_per_nm&#39;</span><span class="p">:</span>
                <span class="n">wl</span> <span class="o">=</span> <span class="n">x_data</span>
                <span class="n">spectrum</span> <span class="o">=</span> <span class="n">y_data</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="mf">1e+9</span> <span class="o">/</span> <span class="n">wl</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;power_density_per_eV&#39;</span><span class="p">:</span>
                <span class="n">wl</span><span class="p">,</span> <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_ev</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;photon_flux_per_eV&#39;</span><span class="p">:</span>
                <span class="n">wl</span><span class="p">,</span> <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_ev</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
                <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectrum</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="mf">1e+9</span> <span class="o">/</span> <span class="n">wl</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;power_density_per_J&#39;</span><span class="p">:</span>
                <span class="n">wl</span><span class="p">,</span> <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_ev</span><span class="p">(</span><span class="n">x_data</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="n">y_data</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;photon_flux_per_J&#39;</span><span class="p">:</span>
                <span class="n">wl</span><span class="p">,</span> <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_ev</span><span class="p">(</span><span class="n">x_data</span> <span class="o">/</span> <span class="n">q</span><span class="p">,</span> <span class="n">y_data</span> <span class="o">*</span> <span class="n">q</span><span class="p">)</span>
                <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectrum</span> <span class="o">*</span> <span class="p">(</span><span class="n">c</span> <span class="o">*</span> <span class="n">h</span> <span class="o">*</span> <span class="mf">1e+9</span> <span class="o">/</span> <span class="n">wl</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;power_density_per_hz&#39;</span><span class="p">:</span>
                <span class="n">wl</span><span class="p">,</span> <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_hz</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">units</span> <span class="o">==</span> <span class="s1">&#39;photon_flux_per_hz&#39;</span><span class="p">:</span>
                <span class="n">wl</span><span class="p">,</span> <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectral_conversion_nm_hz</span><span class="p">(</span><span class="n">x_data</span><span class="p">,</span> <span class="n">y_data</span><span class="p">)</span>
                <span class="n">spectrum</span> <span class="o">=</span> <span class="n">spectrum</span> <span class="o">*</span> <span class="p">(</span><span class="n">h</span> <span class="o">*</span> <span class="n">x_data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Unknown units: </span><span class="si">{0}</span><span class="s1">.</span><span class="se">\n</span><span class="s1">Valid units are: </span><span class="si">{1}</span><span class="s1">.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">units</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_units</span><span class="p">))</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">power_density</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">trapz</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">wl</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">interp1d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">wl</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">spectrum</span><span class="p">,</span> <span class="n">bounds_error</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">assume_sorted</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">output</span>

        <span class="k">except</span> <span class="ne">KeyError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">4.5</span><span class="p">))</span>

    <span class="c1"># The wavelength range of the spectra</span>
    <span class="n">wl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">3000</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="n">gauss</span> <span class="o">=</span> <span class="n">LightSource</span><span class="p">(</span><span class="n">source_type</span><span class="o">=</span><span class="s1">&#39;laser&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">wl</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">power</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
    <span class="n">bb</span> <span class="o">=</span> <span class="n">LightSource</span><span class="p">(</span><span class="n">source_type</span><span class="o">=</span><span class="s1">&#39;black body&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">wl</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">5800</span><span class="p">,</span> <span class="n">entendue</span><span class="o">=</span><span class="s1">&#39;Sun&#39;</span><span class="p">)</span>
    <span class="n">am15g</span> <span class="o">=</span> <span class="n">LightSource</span><span class="p">(</span><span class="n">source_type</span><span class="o">=</span><span class="s1">&#39;standard&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">wl</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="s1">&#39;AM1.5g&#39;</span><span class="p">)</span>
    <span class="n">smarts</span> <span class="o">=</span> <span class="n">LightSource</span><span class="p">(</span><span class="n">source_type</span><span class="o">=</span><span class="s1">&#39;SMARTS&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">wl</span><span class="p">)</span>
    <span class="n">spectral</span> <span class="o">=</span> <span class="n">LightSource</span><span class="p">(</span><span class="n">source_type</span><span class="o">=</span><span class="s1">&#39;SPECTRAL2&#39;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">wl</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">gauss</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Gauss&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">bb</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(),</span>  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Black body&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">am15g</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(),</span>  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;AM1.5G&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">smarts</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(),</span>  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SMARTS&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="o">*</span><span class="n">spectral</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(),</span>  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;SPECTRAL2&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">300</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Wavelength (nm)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Power density (Wm$^{-2}$nm$^{-1}$)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Solcore 5.2.0.dev.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Quantum Photovoltaics Group, Imperial College London.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>