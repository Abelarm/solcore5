
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>solcore.material_data.mobility &#8212; Solcore 5.3.0.dev.1 documentation</title>
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '5.3.0.dev.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Solcore 5.3.0.dev.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/header2.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../Installation/installation.html">Installation and configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Structures/structure.html">Structures and support classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Systems/systems.html">Materials and units</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../QM/Schrodinger.html">Quantum Solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../spectral/spectral.html">Light Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Optics/optics.html">Optical methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Solvers/solving_solar_cells.html">Solar cell solvers</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for solcore.material_data.mobility</h1><div class="highlight"><pre>
<span></span><span class="n">__author__</span> <span class="o">=</span> <span class="s1">&#39;diego&#39;</span>

<span class="sd">&quot;&quot;&quot; Implementation of the mobility model by:</span>

<span class="sd">M. Sotoodeh, A. H. Khalid, and A. A. Rezazadeh,</span>
<span class="sd">“Empirical low-field mobility model for III–V compounds applicable in device simulation codes,”</span>
<span class="sd">J. Appl. Phys., vol. 87, no. 6, p. 2890, 2000.</span>

<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">solcore.science_tracker</span> <span class="k">import</span> <span class="n">science_reference</span>

<span class="c1"># Constants</span>
<span class="n">kb</span> <span class="o">=</span> <span class="mf">8.6173324e-5</span>  <span class="c1"># eV K-1</span>
<span class="n">Log</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="n">this_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">this_dir</span><span class="p">,</span> <span class="s2">&quot;mobility_parameters.json&quot;</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">parameters</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>


<div class="viewcode-block" id="mobility_low_field"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.mobility_low_field">[docs]</a><span class="k">def</span> <span class="nf">mobility_low_field</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">muMin</span><span class="p">,</span> <span class="n">muMax</span><span class="p">,</span> <span class="n">Nref</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">muMin</span> <span class="o">+</span> <span class="p">(</span><span class="n">muMax</span> <span class="o">*</span> <span class="p">(</span><span class="mi">300</span> <span class="o">/</span> <span class="n">T</span><span class="p">)</span> <span class="o">**</span> <span class="n">t1</span> <span class="o">-</span> <span class="n">muMin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="p">(</span><span class="n">Nref</span> <span class="o">*</span> <span class="p">(</span><span class="mi">300</span> <span class="o">/</span> <span class="n">T</span><span class="p">)</span> <span class="o">**</span> <span class="n">t2</span><span class="p">))</span> <span class="o">**</span> <span class="n">l</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="calculate_mobility"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.calculate_mobility">[docs]</a><span class="k">def</span> <span class="nf">calculate_mobility</span><span class="p">(</span><span class="n">material</span><span class="p">,</span> <span class="n">holes</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">300</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the mobility using the model by Sotoodeh et al. If the material is not in the database, then the function returns the mobility for GaAs at that temperature, T, and impurity concentration, N.</span>

<span class="sd">    :param material: A string with the material name</span>
<span class="sd">    :param holes: If calculation should be done for electrons (holes=0) or holes (holes=1)</span>
<span class="sd">    :param N: Impurity concentration</span>
<span class="sd">    :param x: The fractional composition in the case of ternaries</span>
<span class="sd">    :param y: The other fractional composition in the case of quaternaries</span>
<span class="sd">    :param T: Temperature</span>
<span class="sd">    :return: The calculated mobility</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">science_reference</span><span class="p">(</span><span class="s1">&#39;mobility calculator&#39;</span><span class="p">,</span> <span class="s1">&#39;M. Sotoodeh, A. H. Khalid, and A. A. Rezazadeh,&#39;</span>
                                             <span class="s1">&#39;“Empirical low-field mobility model for III–V compounds applicable in device simulation codes,&quot;&#39;</span>
                                             <span class="s1">&#39;J. Appl. Phys., vol. 87, no. 6, p. 2890, 2000.&#39;</span><span class="p">)</span>

    <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">holes</span><span class="p">:</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">if</span> <span class="n">material</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: Material </span><span class="si">{0}</span><span class="s2"> not in the database for the mobility. Reverting to GaAs.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">material</span><span class="p">))</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;GaAs&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">data</span><span class="p">[</span><span class="n">material</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">material</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="k">elif</span> <span class="n">material</span> <span class="o">==</span> <span class="s2">&quot;InGaAs&quot;</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">calculate_InGaAs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">material</span> <span class="o">==</span> <span class="s2">&quot;GaInP&quot;</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">calculate_InGaP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">material</span> <span class="o">==</span> <span class="s2">&quot;AlGaAs&quot;</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">calculate_AlGaAs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">material</span> <span class="o">==</span> <span class="s2">&quot;InAlAs&quot;</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">calculate_InAlAs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">material</span> <span class="o">==</span> <span class="s2">&quot;InGaAsP&quot;</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">calculate_InGaAsP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="n">calculate_General</span><span class="p">(</span><span class="n">material</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>

    <span class="n">muMin</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span>
    <span class="n">muMax</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span>
    <span class="n">Nref</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span>
    <span class="n">t1</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">]</span>
    <span class="n">t2</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span>

    <span class="n">m</span> <span class="o">=</span> <span class="n">mobility_low_field</span><span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="mf">1e6</span><span class="p">,</span> <span class="n">muMin</span><span class="p">,</span> <span class="n">muMax</span><span class="p">,</span> <span class="n">Nref</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10000</span>  <span class="c1"># To convert it from cm2 to m2</span>
    <span class="k">return</span> <span class="n">m</span></div>


<div class="viewcode-block" id="calculate_InGaAs"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.calculate_InGaAs">[docs]</a><span class="k">def</span> <span class="nf">calculate_InGaAs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the parameters for an InGaAs alloy.</span>

<span class="sd">    :param x: Indium fraction</span>
<span class="sd">    :param i: If the data for electrons (1) or holes (2) should be calculated</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">p0</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;InAs&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;InGaAs&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;GaAs&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>

    <span class="n">xi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;InGaAs&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>

    <span class="n">newData</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Log</span><span class="p">(</span><span class="n">p0</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">xi</span><span class="p">))</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">newData</span></div>


<div class="viewcode-block" id="calculate_InGaP"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.calculate_InGaP">[docs]</a><span class="k">def</span> <span class="nf">calculate_InGaP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the parameters for an InGaP alloy.</span>

<span class="sd">    :param x: Indium fraction</span>
<span class="sd">    :param i: If the data for electrons (1) or holes (2) should be calculated</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">p0</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;InP&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;GaInP&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;GaP&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>

    <span class="n">xi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;GaInP&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>

    <span class="n">newData</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Log</span><span class="p">(</span><span class="n">p0</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">xi</span><span class="p">))</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># We have electrons, the above muMin and muMax need to be recalculated in an smarter way to take into</span>
        <span class="c1"># account the indirect bandgap above certain composition</span>

        <span class="n">p0b</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;InP&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">p1b</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;GaInP&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">p2b</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;GaP&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>

        <span class="c1"># We calculate the band parameters for the alloy</span>
        <span class="n">newBand</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">p0b</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;es&quot;</span><span class="p">,</span> <span class="s2">&quot;einf&quot;</span><span class="p">]:</span>
                <span class="n">newBand</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_epsilon</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">p2b</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mnG&quot;</span><span class="p">,</span> <span class="s2">&quot;mnX&quot;</span><span class="p">,</span> <span class="s2">&quot;mnL&quot;</span><span class="p">]:</span>
                <span class="n">newBand</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">p2b</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newBand</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">p2b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ABC</span><span class="o">=</span><span class="n">p1b</span><span class="p">[</span><span class="s2">&quot;b</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">])])</span>

        <span class="c1"># Now we use these to calculate the direct and indirect mobilities (max and min)</span>
        <span class="n">muDmax</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span> <span class="o">*</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span>
        <span class="n">muDmin</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span> <span class="o">*</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span>

        <span class="n">mind_alloy</span> <span class="o">=</span> <span class="n">mind</span><span class="p">(</span><span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgX&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgL&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnX&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnL&quot;</span><span class="p">],</span> <span class="n">T</span><span class="p">)</span>
        <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2b</span><span class="p">[</span><span class="s2">&quot;mnX&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">mind_alloy</span><span class="p">)</span> <span class="o">**</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2b</span><span class="p">[</span><span class="s2">&quot;einf&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">p2b</span><span class="p">[</span><span class="s2">&quot;es&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;einf&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;es&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">muImax</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span>
        <span class="n">muImin</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">Rd</span><span class="p">(</span><span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgG&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgX&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgL&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnG&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnX&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnL&quot;</span><span class="p">],</span> <span class="n">T</span><span class="p">)</span>

        <span class="c1"># Finally</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">muDmin</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">muImin</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">muDmax</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">muImax</span>

    <span class="k">return</span> <span class="n">newData</span></div>


<div class="viewcode-block" id="calculate_AlGaAs"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.calculate_AlGaAs">[docs]</a><span class="k">def</span> <span class="nf">calculate_AlGaAs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the parameters for an AlGaAs alloy.</span>

<span class="sd">    :param x: Al fraction</span>
<span class="sd">    :param i: If the data for electrons (1) or holes (2) should be calculated</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">p0</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;AlAs&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;AlGaAs&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;GaAs&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>

    <span class="n">xi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;AlGaAs&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>

    <span class="n">newData</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># We have holes, which are easy: quadratic interpolation between AlAs, Al0.3GaAs and GaAs.</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Log</span><span class="p">(</span><span class="n">p0</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">xi</span><span class="p">))</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We have electrons. Data is interpolated linearly between AlAs and GaAs</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Log</span><span class="p">(</span><span class="n">p0</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">])))</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">])</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">])</span>

        <span class="c1"># For muMin and muMax need to be recalculated in an smarter way to take into</span>
        <span class="c1"># account the indirect bandgap above certain composition</span>

        <span class="n">p0b</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;AlAs&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">p1b</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;AlGaAs&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">p2b</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;GaAs&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>

        <span class="c1"># We calculate the band parameters for the alloy</span>
        <span class="n">newBand</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">p0b</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;es&quot;</span><span class="p">,</span> <span class="s2">&quot;einf&quot;</span><span class="p">]:</span>
                <span class="n">newBand</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_epsilon</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">p2b</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mnG&quot;</span><span class="p">,</span> <span class="s2">&quot;mnX&quot;</span><span class="p">,</span> <span class="s2">&quot;mnL&quot;</span><span class="p">]:</span>
                <span class="n">newBand</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">p2b</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newBand</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">p2b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ABC</span><span class="o">=</span><span class="n">p1b</span><span class="p">[</span><span class="s2">&quot;b</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">])])</span>

        <span class="c1"># Now we use these to calculate the direct and indirect mobilities (max and min)</span>
        <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2b</span><span class="p">[</span><span class="s2">&quot;mnG&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnG&quot;</span><span class="p">])</span> <span class="o">**</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2b</span><span class="p">[</span><span class="s2">&quot;einf&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">p2b</span><span class="p">[</span><span class="s2">&quot;es&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;einf&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;es&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">muDmax</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span>
        <span class="n">muDmin</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span>

        <span class="n">muImax</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span>
        <span class="n">muImin</span> <span class="o">=</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">Rd</span><span class="p">(</span><span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgG&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgX&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgL&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnG&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnX&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnL&quot;</span><span class="p">],</span> <span class="n">T</span><span class="p">)</span>

        <span class="c1"># Finally</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">muDmin</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">muImin</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">muDmax</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">muImax</span>

    <span class="k">return</span> <span class="n">newData</span></div>


<div class="viewcode-block" id="calculate_InAlAs"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.calculate_InAlAs">[docs]</a><span class="k">def</span> <span class="nf">calculate_InAlAs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the parameters for an InAlAs alloy.</span>

<span class="sd">    :param x: Al fraction</span>
<span class="sd">    :param i: If the data for electrons (1) or holes (2) should be calculated</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">p0</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;InAs&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;InAlAs&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">p2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;AlAs&quot;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>

    <span class="n">xi</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;InAlAs&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">][</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>

    <span class="n">newData</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># We have holes, which are easy</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">])</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Log</span><span class="p">(</span><span class="n">p0</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">])))</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">])</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">])</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We have electrons</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Log</span><span class="p">(</span><span class="n">p0</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p2</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">xi</span><span class="p">))</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">xi</span><span class="p">)</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">])</span>

        <span class="c1"># For muMin and muMax need to be recalculated in an smarter way to take into</span>
        <span class="c1"># account the indirect bandgap above certain composition</span>

        <span class="n">p0b</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;InAs&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">p1b</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;InAlAs&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">p2b</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;AlAs&quot;</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>

        <span class="c1"># We calculate the band parameters for the alloy</span>
        <span class="n">newBand</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">p0b</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;es&quot;</span><span class="p">,</span> <span class="s2">&quot;einf&quot;</span><span class="p">]:</span>
                <span class="n">newBand</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_epsilon</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">p2b</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;mnG&quot;</span><span class="p">,</span> <span class="s2">&quot;mnX&quot;</span><span class="p">,</span> <span class="s2">&quot;mnL&quot;</span><span class="p">]:</span>
                <span class="n">newBand</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">p2b</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">newBand</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">p2b</span><span class="p">[</span><span class="n">key</span><span class="p">],</span> <span class="n">ABC</span><span class="o">=</span><span class="n">p1b</span><span class="p">[</span><span class="s2">&quot;b</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="mi">2</span><span class="p">])])</span>

        <span class="c1"># Now we use these to calculate the direct and indirect mobilities (max and min)</span>
        <span class="n">f1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">xi</span><span class="p">)</span>
        <span class="n">f2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">xi</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">muDmax</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="n">f2</span>
        <span class="n">muDmin</span> <span class="o">=</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">**</span> <span class="n">f2</span>

        <span class="n">mind_alloy</span> <span class="o">=</span> <span class="n">mind</span><span class="p">(</span><span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgX&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgL&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnX&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnL&quot;</span><span class="p">],</span> <span class="n">T</span><span class="p">)</span>
        <span class="n">C</span> <span class="o">=</span> <span class="p">(</span><span class="n">p2b</span><span class="p">[</span><span class="s2">&quot;mnX&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">mind_alloy</span><span class="p">)</span> <span class="o">**</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">p2b</span><span class="p">[</span><span class="s2">&quot;einf&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">p2b</span><span class="p">[</span><span class="s2">&quot;es&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span>
        <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;einf&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;es&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>

        <span class="n">muImax</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span>
        <span class="n">muImin</span> <span class="o">=</span> <span class="n">C</span> <span class="o">*</span> <span class="n">p2</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span>

        <span class="n">f</span> <span class="o">=</span> <span class="n">Rd</span><span class="p">(</span><span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgG&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgX&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;EgL&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnG&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnX&quot;</span><span class="p">],</span> <span class="n">newBand</span><span class="p">[</span><span class="s2">&quot;mnL&quot;</span><span class="p">],</span> <span class="n">T</span><span class="p">)</span>

        <span class="c1"># Finally</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">muDmin</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">muImin</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">f</span> <span class="o">*</span> <span class="n">muDmax</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">muImax</span>

    <span class="k">return</span> <span class="n">newData</span></div>


<div class="viewcode-block" id="calculate_InGaAsP"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.calculate_InGaAsP">[docs]</a><span class="k">def</span> <span class="nf">calculate_InGaAsP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the parameters for an InGaAsP alloy. The calculation is based on a interpolation scheme between</span>
<span class="sd">    InGaP and InGaAs using data of compositions lattice matched to InP. Results for compositions away from this might</span>
<span class="sd">    not be very accurate.</span>

<span class="sd">    :param x: Indium fraction</span>
<span class="sd">    :param y: Phosphorus fraction</span>
<span class="sd">    :param i: If the data for electrons (1) or holes (2) should be calculated</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">p0</span> <span class="o">=</span> <span class="n">calculate_InGaP</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">calculate_InGaAs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

    <span class="n">newData</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">Log</span><span class="p">(</span><span class="n">p0</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">])))</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">])</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">])</span>

    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># We have holes</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># We have electrons</span>
        <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">])</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">6</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">y</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">newData</span></div>


<div class="viewcode-block" id="calculate_General"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.calculate_General">[docs]</a><span class="k">def</span> <span class="nf">calculate_General</span><span class="p">(</span><span class="n">material</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the parameters for a general alloy of the materials in the database assuming a simple linear</span>
<span class="sd">    interpolation. Only ternaries are supported this way.</span>

<span class="sd">    :param material: Material to calculate, which must be in the database</span>
<span class="sd">    :param x: Main fraction</span>
<span class="sd">    :param i: If the data for electrons (1) or holes (2) should be calculated</span>
<span class="sd">    :return:</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">parent1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">material</span><span class="p">][</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">parent2</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">material</span><span class="p">][</span><span class="mi">5</span><span class="p">]</span>

    <span class="n">p0</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">parent1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
    <span class="n">p1</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">parent2</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>

    <span class="n">newData</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMin&quot;</span><span class="p">])</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;muMax&quot;</span><span class="p">])</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">**</span> <span class="p">(</span><span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Log</span><span class="p">(</span><span class="n">p0</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">]),</span> <span class="n">Log</span><span class="p">(</span><span class="n">p1</span><span class="p">[</span><span class="s2">&quot;Nref&quot;</span><span class="p">])))</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;l&quot;</span><span class="p">])</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;t1&quot;</span><span class="p">])</span>
    <span class="n">newData</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">p0</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">],</span> <span class="n">p1</span><span class="p">[</span><span class="s2">&quot;t2&quot;</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">newData</span></div>


<div class="viewcode-block" id="Rd"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.Rd">[docs]</a><span class="k">def</span> <span class="nf">Rd</span><span class="p">(</span><span class="n">EgG</span><span class="p">,</span> <span class="n">EgX</span><span class="p">,</span> <span class="n">EgL</span><span class="p">,</span> <span class="n">mnG</span><span class="p">,</span> <span class="n">mnX</span><span class="p">,</span> <span class="n">mnL</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Calculates the fraction of electrons in the direct valley.</span>

<span class="sd">    :param EgG: Gamma-valley bandgap</span>
<span class="sd">    :param EgX: X-valley bandgap</span>
<span class="sd">    :param EgL: L-valley bandgap</span>
<span class="sd">    :param mnG: Gamma-valley effective mass</span>
<span class="sd">    :param mnX: X-valley effective mass</span>
<span class="sd">    :param mnL: L-valley effective mass</span>
<span class="sd">    :param T: The temperature</span>
<span class="sd">    :return: The fraction.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">RX</span> <span class="o">=</span> <span class="p">(</span><span class="n">mnX</span> <span class="o">/</span> <span class="n">mnG</span><span class="p">)</span> <span class="o">**</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">EgG</span> <span class="o">-</span> <span class="n">EgX</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kb</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>
    <span class="n">RL</span> <span class="o">=</span> <span class="p">(</span><span class="n">mnL</span> <span class="o">/</span> <span class="n">mnG</span><span class="p">)</span> <span class="o">**</span> <span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">EgG</span> <span class="o">-</span> <span class="n">EgL</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kb</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>

    <span class="n">fraction</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">RX</span> <span class="o">+</span> <span class="n">RL</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fraction</span></div>


<div class="viewcode-block" id="mind"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.mind">[docs]</a><span class="k">def</span> <span class="nf">mind</span><span class="p">(</span><span class="n">EgX</span><span class="p">,</span> <span class="n">EgL</span><span class="p">,</span> <span class="n">mnX</span><span class="p">,</span> <span class="n">mnL</span><span class="p">,</span> <span class="n">T</span><span class="p">):</span>
    <span class="n">RX</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">((</span><span class="n">EgL</span> <span class="o">-</span> <span class="n">EgX</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">kb</span> <span class="o">*</span> <span class="n">T</span><span class="p">))</span>

    <span class="n">fraction</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">RX</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">mnL</span> <span class="o">*</span> <span class="n">fraction</span> <span class="o">+</span> <span class="n">mnX</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">fraction</span><span class="p">)</span></div>


<div class="viewcode-block" id="interpolate_parameter_linear"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.interpolate_parameter_linear">[docs]</a><span class="k">def</span> <span class="nf">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">AC</span><span class="p">,</span> <span class="n">BC</span><span class="p">,</span> <span class="n">ABC</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">AC</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">BC</span> <span class="o">-</span> <span class="n">ABC</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span></div>


<div class="viewcode-block" id="interpolate_parameter_quad"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.interpolate_parameter_quad">[docs]</a><span class="k">def</span> <span class="nf">interpolate_parameter_quad</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">x1</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">x2</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">dem0</span> <span class="o">=</span> <span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x0</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">dem1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">dem2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>

    <span class="n">nom0</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">nom1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span>
    <span class="n">nom2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x1</span><span class="p">)</span>

    <span class="n">p</span> <span class="o">=</span> <span class="n">y0</span> <span class="o">*</span> <span class="n">nom0</span> <span class="o">/</span> <span class="n">dem0</span> <span class="o">+</span> <span class="n">y1</span> <span class="o">*</span> <span class="n">nom1</span> <span class="o">/</span> <span class="n">dem1</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">*</span> <span class="n">nom2</span> <span class="o">/</span> <span class="n">dem2</span>

    <span class="k">return</span> <span class="n">p</span></div>


<div class="viewcode-block" id="interpolate_epsilon"><a class="viewcode-back" href="../../../Systems/Materials.html#solcore.material_data.mobility.interpolate_epsilon">[docs]</a><span class="k">def</span> <span class="nf">interpolate_epsilon</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">AC</span><span class="p">,</span> <span class="n">BC</span><span class="p">):</span>
    <span class="n">ratioAC</span> <span class="o">=</span> <span class="p">(</span><span class="n">AC</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">AC</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">ratioBC</span> <span class="o">=</span> <span class="p">(</span><span class="n">BC</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">BC</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>

    <span class="n">k</span> <span class="o">=</span> <span class="n">interpolate_parameter_linear</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">ratioAC</span><span class="p">,</span> <span class="n">ratioBC</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="n">N</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="c1"># mo = calculate_mobility(&quot;InGaAsP&quot;, 0, N=1e17, x=x, y=0.5, T=300)</span>
    <span class="n">mo</span> <span class="o">=</span> <span class="n">calculate_mobility</span><span class="p">(</span><span class="s2">&quot;GaInP&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="o">=</span><span class="mf">1e23</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">T</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>
    <span class="c1"># mo = calculate_mobility(&quot;GaAs&quot;, 0, N=N, x=0, T=300)</span>

    <span class="c1"># plt.semilogx(N, mo)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mo</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Solcore 5.3.0.dev.1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Quantum Photovoltaics Group, Imperial College London.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.6.
    </div>
  </body>
</html>