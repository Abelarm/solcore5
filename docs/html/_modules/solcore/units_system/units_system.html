
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>solcore.units_system.units_system &#8212; Solcore 5.0.2 documentation</title>
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '5.0.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head>
  <body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Solcore 5.0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../../../index.html">
              <img class="logo" src="../../../_static/header2.png" alt="Logo"/>
            </a></p>
<h3><a href="../../../index.html">Table Of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation and configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../structure.html">Structures and support classes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Systems/Units.html">The Units System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Systems/Parameters.html">The Parameters System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Systems/Materials.html">The Materials System</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Systems/Mobility.html">The mobility module</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../QM/Schrodinger.html">1D arbitrary potential Schrödinger and k•p band structure solvers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../Absorption/Absorption.html">Absorption calculator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../spectral/spectral.html">Light Sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../ASC/ASC.html">Analytic solar cells calculator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../PDD/DDsolver.html">Poisson - Drift-Diffusion solver (PDD)</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for solcore.units_system.units_system</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>
<span class="kn">import</span> <span class="nn">re</span>  <span class="c1"># tools to manage regular expresions</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">solcore</span>
<span class="kn">from</span> <span class="nn">solcore.source_managed_class</span> <span class="k">import</span> <span class="n">SourceManagedClass</span>
<span class="kn">from</span> <span class="nn">solcore.constants</span> <span class="k">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">solcore.singleton</span> <span class="k">import</span> <span class="n">Singleton</span>


<div class="viewcode-block" id="UnitError"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitError">[docs]</a><span class="k">class</span> <span class="nc">UnitError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="ne">BaseException</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="WrongDimensionError"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.WrongDimensionError">[docs]</a><span class="k">class</span> <span class="nc">WrongDimensionError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="ne">BaseException</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="generateConversionDictForSISuffix"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.generateConversionDictForSISuffix">[docs]</a><span class="k">def</span> <span class="nf">generateConversionDictForSISuffix</span><span class="p">(</span><span class="n">suffix</span><span class="p">,</span> <span class="n">centi</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">deci</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">non_base_si_factor</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">prefixes</span> <span class="o">=</span> <span class="s2">&quot;Y,Z,E,P,T,G,M,k.txt,,m,u,n,p,f,a,z,y&quot;</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">)</span>
    <span class="n">exponents</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">if</span> <span class="n">centi</span><span class="p">:</span>
        <span class="n">prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;c&quot;</span><span class="p">)</span>
        <span class="n">exponents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mf">2.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">deci</span><span class="p">:</span>
        <span class="n">prefixes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;d&quot;</span><span class="p">)</span>
        <span class="n">exponents</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">3.</span><span class="p">)</span>

    <span class="n">unitNames</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;</span><span class="si">%s%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">prefix</span><span class="p">,</span> <span class="n">suffix</span><span class="p">)</span> <span class="k">for</span> <span class="n">prefix</span> <span class="ow">in</span> <span class="n">prefixes</span><span class="p">]</span>
    <span class="n">conversion</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1000.</span> <span class="o">**</span> <span class="n">exponent</span> <span class="o">*</span> <span class="n">non_base_si_factor</span> <span class="k">for</span> <span class="n">exponent</span> <span class="ow">in</span> <span class="n">exponents</span><span class="p">]</span>

    <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">unitNames</span><span class="p">,</span> <span class="n">conversion</span><span class="p">))</span></div>


<div class="viewcode-block" id="UnitsSystem"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem">[docs]</a><span class="k">class</span> <span class="nc">UnitsSystem</span><span class="p">(</span><span class="n">SourceManagedClass</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Contains all the functions related with the conversion of units. While defined inside this class, most of these</span>
<span class="sd">    functions are available outside it, being decorated with &#39;breakout&#39; (see &#39;Singleton&#39;)&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sources</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">SourceManagedClass</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">separate_value_and_unit_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;([-+]?[0-9]*\.?[0-9]+(?:[eE][-+]?[0-9]+)?)(?:[ </span><span class="se">\t</span><span class="s2">]*(.*))?&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">split_units_RE</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">u</span><span class="s2">&quot;(?:([^ \+\-\^\.0-9]+)[\^]?([\-\+]?[^ \-\+]*)?)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">siConversions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">sources</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_source</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;SOLCORE_ROOT&#39;</span><span class="p">,</span> <span class="n">solcore</span><span class="o">.</span><span class="n">SOLCORE_ROOT</span><span class="p">)))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

<div class="viewcode-block" id="UnitsSystem.read"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.read">[docs]</a>    <span class="k">def</span> <span class="nf">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Reads the units file and creates a database with all units and conversion factors. &quot;&quot;&quot;</span>
        <span class="n">SourceManagedClass</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">si_conversions</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">dimension</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">sections</span><span class="p">():</span>
            <span class="n">units</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">options</span><span class="p">(</span><span class="n">dimension</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">units</span><span class="p">:</span>
                <span class="k">if</span> <span class="s2">&quot;META_GenerateConversions&quot;</span> <span class="ow">in</span> <span class="n">unit</span><span class="p">:</span>
                    <span class="n">expression</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
                    <span class="n">si_base_unit</span> <span class="o">=</span> <span class="n">expression</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="n">centi</span> <span class="o">=</span> <span class="s2">&quot;centi&quot;</span> <span class="ow">in</span> <span class="n">expression</span>
                    <span class="n">deci</span> <span class="o">=</span> <span class="s2">&quot;deci&quot;</span> <span class="ow">in</span> <span class="n">expression</span>
                    <span class="n">non_base_si_factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_eval</span><span class="p">(</span><span class="n">expression</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span> <span class="k">if</span> <span class="s2">&quot;altbase&quot;</span> <span class="ow">in</span> <span class="n">expression</span> <span class="k">else</span> <span class="mi">1</span>
                    <span class="n">dimension_conversions</span> <span class="o">=</span> <span class="n">generateConversionDictForSISuffix</span><span class="p">(</span>
                        <span class="n">si_base_unit</span><span class="p">,</span>
                        <span class="n">centi</span><span class="o">=</span><span class="n">centi</span><span class="p">,</span>
                        <span class="n">deci</span><span class="o">=</span><span class="n">deci</span><span class="p">,</span>
                        <span class="n">non_base_si_factor</span><span class="o">=</span><span class="n">non_base_si_factor</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">siConversions</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dimension_conversions</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="n">dimension</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dimension_conversions</span><span class="p">)</span>
                    <span class="k">continue</span>
                <span class="n">string_expression</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">database</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dimension</span><span class="p">,</span> <span class="n">unit</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">siConversions</span><span class="p">[</span><span class="n">unit</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">safe_eval</span><span class="p">(</span><span class="n">string_expression</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="n">dimension</span><span class="p">][</span><span class="n">unit</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">siConversions</span><span class="p">[</span><span class="n">unit</span><span class="p">]</span></div>

<div class="viewcode-block" id="UnitsSystem.safe_eval"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.safe_eval">[docs]</a>    <span class="k">def</span> <span class="nf">safe_eval</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string_expression</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">eval</span><span class="p">(</span><span class="n">string_expression</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;__builtins__&quot;</span><span class="p">:</span> <span class="p">{}},</span> <span class="p">{</span><span class="s2">&quot;constants&quot;</span><span class="p">:</span> <span class="n">solcore</span><span class="o">.</span><span class="n">constants</span><span class="p">})</span></div>

<div class="viewcode-block" id="UnitsSystem.siUnits"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.siUnits">[docs]</a>    <span class="k">def</span> <span class="nf">siUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Convert value from unit to equivalent si-unit</span>

<span class="sd">        &gt;&gt;&gt; print(siUnits(1,&quot;mm&quot;)) # yields meters</span>
<span class="sd">        0.001</span>
<span class="sd">        &gt;&gt;&gt; print(siUnits(1,&quot;um&quot;)) # yields meters</span>
<span class="sd">        1e-06</span>

<span class="sd">        :param value: the value to convert</span>
<span class="sd">        :param unit: the units of the value</span>
<span class="sd">        :return: the value expresed in SI units</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="n">units_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_units_RE</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">unit</span><span class="p">,</span> <span class="n">power</span> <span class="ow">in</span> <span class="n">units_list</span><span class="p">:</span>
            <span class="n">power</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">power</span><span class="p">)</span> <span class="k">if</span> <span class="n">power</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">siConversions</span><span class="p">[</span><span class="n">unit</span><span class="p">]),</span>
                                     <span class="n">power</span><span class="p">)</span>  <span class="c1">### caution, *= is WRONG because it modifies original obj. DO NOT WANT</span>

        <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="UnitsSystem.asUnit"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.asUnit">[docs]</a>    <span class="k">def</span> <span class="nf">asUnit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Converts from si unit to other unit. It is the reversed of siUnits function</span>

<span class="sd">        &gt;&gt;&gt; print(asUnit(1, &quot;mA&quot;)) # print 1A in mA.</span>
<span class="sd">        1000.0</span>

<span class="sd">        :param value: the value to convert, assumed in SI units</span>
<span class="sd">        :param unit: the new units</span>
<span class="sd">        :param dimension: the value expressed in the new units.</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">unit</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="n">units_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_units_RE</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">unit</span><span class="p">,</span> <span class="n">power</span> <span class="ow">in</span> <span class="n">units_list</span><span class="p">:</span>
            <span class="n">power</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">power</span><span class="p">)</span> <span class="k">if</span> <span class="n">power</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">siConversions</span><span class="p">[</span><span class="n">unit</span><span class="p">])</span> <span class="o">**</span> <span class="n">power</span>  <span class="c1">### caution, /= is WRONG because it modifies original obj. DO NOT WANT</span>

        <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="UnitsSystem.si"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.si">[docs]</a>    <span class="k">def</span> <span class="nf">si</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Utility function that forwards to either siUnit or siUnitFromString&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">siUnitFromString</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">siUnits</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span></div>

<div class="viewcode-block" id="UnitsSystem.siUnitFromString"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.siUnitFromString">[docs]</a>    <span class="k">def</span> <span class="nf">siUnitFromString</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">string</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Converts a string of a number with units into si units of that quantity</span>

<span class="sd">        &gt;&gt;&gt; print(si(&quot;5 mm s-1&quot;)) # output in m/s</span>
<span class="sd">        0.005</span>
<span class="sd">        &gt;&gt;&gt; print(si(&quot;5e-0mm-2&quot;)) # output in m2</span>
<span class="sd">        5000000.0</span>
<span class="sd">        &gt;&gt;&gt; print(si(&quot;5&quot;))</span>
<span class="sd">        5.0</span>

<span class="sd">        :param string: the string to convert</span>
<span class="sd">        :return: the value in SI units</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if unit is None or value is None:</span>
        <span class="c1">#     return value</span>

        <span class="n">matchObj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">separate_value_and_unit_RE</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="n">matchObj</span><span class="o">.</span><span class="n">groups</span><span class="p">()</span>
        <span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">units_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">split_units_RE</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">unit</span><span class="p">,</span> <span class="n">power</span> <span class="ow">in</span> <span class="n">units_list</span><span class="p">:</span>
            <span class="n">power</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">power</span><span class="p">)</span> <span class="k">if</span> <span class="n">power</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span> <span class="k">else</span> <span class="mi">1</span>
            <span class="n">value</span> <span class="o">*=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">siConversions</span><span class="p">[</span><span class="n">unit</span><span class="p">])</span> <span class="o">**</span> <span class="n">power</span>
        <span class="k">return</span> <span class="n">value</span></div>

<div class="viewcode-block" id="UnitsSystem.convert"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.convert">[docs]</a>    <span class="k">def</span> <span class="nf">convert</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">from_unit</span><span class="p">,</span> <span class="n">to_unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Converts between comparable units, does NOT check if units are comparable.</span>

<span class="sd">        &gt;&gt;&gt; print(convert(1, &quot;nm&quot;, &quot;mm&quot;))</span>
<span class="sd">        1e-06</span>
<span class="sd">        &gt;&gt;&gt; print(convert(1, &quot;um&quot;, &quot;nm&quot;))</span>
<span class="sd">        1000.0</span>
<span class="sd">        &gt;&gt;&gt; print(convert(1, &quot;cm s-1&quot;, &quot;km h-1&quot;))</span>
<span class="sd">        0.036</span>

<span class="sd">        :param value: the value ot convert</span>
<span class="sd">        :param from_unit: the original unit</span>
<span class="sd">        :param to_unit: the final unit</span>
<span class="sd">        :return: the value expressed in the final unit</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">asUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">siUnits</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">from_unit</span><span class="p">),</span> <span class="n">to_unit</span><span class="p">)</span></div>

<div class="viewcode-block" id="UnitsSystem.eVnm"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.eVnm">[docs]</a>    <span class="k">def</span> <span class="nf">eVnm</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Bi-directional conversion between nm and eV.</span>

<span class="sd">        &gt;&gt;&gt; print(&#39;%.3f&#39;%eVnm(1000))</span>
<span class="sd">        1.240</span>
<span class="sd">        &gt;&gt;&gt; print(&#39;%i&#39;%round(eVnm(1)))</span>
<span class="sd">        1240</span>

<span class="sd">        :param value: a number with units [nm] or [eV].</span>
<span class="sd">        :return: either the conversion [nm] --&gt; [eV], or [eV] --&gt; [nm]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asUnit</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="s2">&quot;eV&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">asUnit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s2">&quot;nm&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">factor</span> <span class="o">/</span> <span class="n">value</span></div>

<div class="viewcode-block" id="UnitsSystem.nmJ"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.nmJ">[docs]</a>    <span class="k">def</span> <span class="nf">nmJ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Bi-directional conversion between nm and J.</span>

<span class="sd">        &gt;&gt;&gt; print(nmJ(1000))</span>
<span class="sd">        1.9864452126e-19</span>
<span class="sd">        &gt;&gt;&gt; print(nmJ(2e-18))</span>
<span class="sd">        99.3222606298</span>

<span class="sd">        :param value: a number with units [nm] or [J].</span>
<span class="sd">        :return: either the conversion [nm] --&gt; [J], or [J] --&gt; [nm]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">c</span>
        <span class="k">return</span> <span class="n">factor</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">siUnits</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="s2">&quot;nm&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="UnitsSystem.mJ"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.mJ">[docs]</a>    <span class="k">def</span> <span class="nf">mJ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Bi-directional conversion between m and J.</span>

<span class="sd">        &gt;&gt;&gt; print(mJ(1000))</span>
<span class="sd">        1.986445212595144e-25</span>
<span class="sd">        &gt;&gt;&gt; print(mJ(2e-18))</span>
<span class="sd">        9.93222606297572e-08</span>

<span class="sd">        :param value: a number with units [m] or [J].</span>
<span class="sd">        :return: either the conversion [m] --&gt; [J], or [J] --&gt; [m]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">c</span>
        <span class="k">return</span> <span class="n">factor</span> <span class="o">/</span> <span class="n">value</span></div>

<div class="viewcode-block" id="UnitsSystem.nmHz"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.nmHz">[docs]</a>    <span class="k">def</span> <span class="nf">nmHz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Bi-directional conversion between nm and Hz.</span>

<span class="sd">        :param value: a number with units [nm] or [Hz].</span>
<span class="sd">        :return: Either a number which is the conversion [nm] --&gt; [Hz] or [Hz] --&gt; [nm]</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">factor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asUnit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s2">&quot;nm s-1&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">factor</span> <span class="o">/</span> <span class="n">value</span></div>

<div class="viewcode-block" id="UnitsSystem.spectral_conversion_nm_ev"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.spectral_conversion_nm_ev">[docs]</a>    <span class="k">def</span> <span class="nf">spectral_conversion_nm_ev</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Bi-directional conversion between a spectrum per nanometer and a spectrum per electronvolt.</span>

<span class="sd">        Example:</span>
<span class="sd">        1) nm --&gt; eV conversion</span>
<span class="sd">        wavelength_nm</span>
<span class="sd">        photon_flux_per_nm</span>
<span class="sd">        energy_ev, photon_flux_per_ev = spectral_conversion_nm_ev(wavelength_nm, photon_flux_per_nm)</span>

<span class="sd">        2) eV --&gt; nm conversion</span>
<span class="sd">        energy_ev</span>
<span class="sd">        photon_flux_per_ev</span>
<span class="sd">        wavelength_nm, photon_flux_per_nm = spectral_conversion_nm_ev(energy_ev, photon_flux_per_ev)</span>

<span class="sd">        Discussion:</span>
<span class="sd">        A physical quantities such as total number of photon in a spectrum or</span>
<span class="sd">        total energy of a spectrum should remain invariant after a transformation</span>
<span class="sd">        to different units. This is called a spectral conversion. This function</span>
<span class="sd">        is bi-directional because the mathematics of the conversion processes</span>
<span class="sd">        is symmetrical.</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; x = np.array([1,2,3])</span>
<span class="sd">        &gt;&gt;&gt; y = np.array([1,1,1])</span>
<span class="sd">        &gt;&gt;&gt; area_before = np.trapz(y, x=x)</span>
<span class="sd">        &gt;&gt;&gt; x_new, y_new = spectral_conversion_nm_ev(x, y)</span>
<span class="sd">        &gt;&gt;&gt; area_after = np.trapz(y_new, x=x_new)</span>
<span class="sd">        &gt;&gt;&gt; compare_floats(area_before, area_after, relative_precision=0.2)</span>
<span class="sd">        True</span>

<span class="sd">        :param x: abscissa of the spectrum in units of [nm] or [eV]</span>
<span class="sd">        :param y: ordinate of the spectrum in units of [something/nm] or [something/eV]</span>
<span class="sd">        :return: A tuple (x, y) which has units either [eV, something/eV] or [nm. something/nm].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_prime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eVnm</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">conversion_constant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asUnit</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="s2">&quot;eV s&quot;</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">asUnit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s2">&quot;nm s-1&quot;</span><span class="p">)</span>
        <span class="n">y_prime</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">conversion_constant</span> <span class="o">/</span> <span class="n">x_prime</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">y_prime</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="n">y_prime</span><span class="p">)</span>  <span class="c1"># Wavelength ascends as electronvolts decends therefore reverse arrays</span>
        <span class="n">x_prime</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="n">x_prime</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x_prime</span><span class="p">,</span> <span class="n">y_prime</span><span class="p">)</span></div>

<div class="viewcode-block" id="UnitsSystem.spectral_conversion_nm_hz"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.spectral_conversion_nm_hz">[docs]</a>    <span class="k">def</span> <span class="nf">spectral_conversion_nm_hz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Bi-directional conversion between a spectrum per nanometer and a spectrum per Hertz.</span>

<span class="sd">        Example:</span>
<span class="sd">        1) nm --&gt; Hz conversion</span>
<span class="sd">        wavelength_nm</span>
<span class="sd">        photon_flux_per_nm</span>
<span class="sd">        energy_hz, photon_flux_per_hz = spectral_conversion_nm_hz(wavelength_nm, photon_flux_per_nm)</span>

<span class="sd">        2) Hz --&gt; nm conversion</span>
<span class="sd">        energy_hz</span>
<span class="sd">        photon_flux_per_hz</span>
<span class="sd">        wavelength_nm, photon_flux_per_nm = spectral_conversion_nm_ev(energy_hz, photon_flux_per_hz)</span>

<span class="sd">        Discussion:</span>
<span class="sd">        A physical quantities such as total number of photon in a spectrum or</span>
<span class="sd">        total energy of a spectrum should remain invariant after a transformation</span>
<span class="sd">        to different units. This is called a spectral conversion. This function</span>
<span class="sd">        is bi-directional because the mathematics of the conversion processes</span>
<span class="sd">        is symmetrical.</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; x = np.array([1,2,3])</span>
<span class="sd">        &gt;&gt;&gt; y = np.array([1,1,1])</span>
<span class="sd">        &gt;&gt;&gt; area_before = np.trapz(y, x=x)</span>
<span class="sd">        &gt;&gt;&gt; x_new, y_new = spectral_conversion_nm_hz(x, y)</span>
<span class="sd">        &gt;&gt;&gt; area_after = np.trapz(y_new, x=x_new)</span>
<span class="sd">        &gt;&gt;&gt; compare_floats(area_before, area_after, relative_precision=0.2)</span>
<span class="sd">        True</span>

<span class="sd">        :param x: abscissa of the spectrum in units of [nm] or [Hz]</span>
<span class="sd">        :param y: ordinate of the spectrum in units of [something/nm] or [something/Hz]</span>
<span class="sd">        :return: A tuple (x, y) which has units either [eV, something/nm] or [nm. something/Hz].</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x_prime</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nmHz</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">conversion_constant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">asUnit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="s2">&quot;nm s-1&quot;</span><span class="p">)</span>
        <span class="n">y_prime</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="n">conversion_constant</span> <span class="o">/</span> <span class="n">x_prime</span> <span class="o">**</span> <span class="mi">2</span>
        <span class="n">y_prime</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="n">y_prime</span><span class="p">)</span>  <span class="c1"># Wavelength ascends as frequency decends therefore reverse arrays</span>
        <span class="n">x_prime</span> <span class="o">=</span> <span class="n">reverse</span><span class="p">(</span><span class="n">x_prime</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x_prime</span><span class="p">,</span> <span class="n">y_prime</span><span class="p">)</span></div>

<div class="viewcode-block" id="UnitsSystem.sensibleUnits"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.sensibleUnits">[docs]</a>    <span class="k">def</span> <span class="nf">sensibleUnits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">dimension</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Attempt to convert a physical quantity of a particular dimension to the most sensible units</span>

<span class="sd">        &gt;&gt;&gt; print(sensibleUnits(0.001,&quot;length&quot;,0))</span>
<span class="sd">        1 mm</span>
<span class="sd">        &gt;&gt;&gt; print(sensibleUnits(1000,&quot;length&quot;,0))</span>
<span class="sd">        1 km</span>
<span class="sd">        &gt;&gt;&gt; print(sensibleUnits(si(&quot;0.141 days&quot;),&quot;time&quot;, 5))</span>
<span class="sd">        3.38400 h</span>

<span class="sd">        :param value: The value to re-calculate in SI units</span>
<span class="sd">        :param dimension: The dimension of the value. Possible values are: &#39;luminous intensity&#39;, &#39;pressure&#39;, &#39;time&#39;,</span>
<span class="sd">         &#39;angle&#39;, &#39;temperature&#39;, &#39;current&#39;, &#39;force&#39;, &#39;charge&#39;, &#39;power&#39;, &#39;voltage&#39;, &#39;resistance&#39;, &#39;mass&#39;, &#39;length&#39;, &#39;energy&#39;</span>
<span class="sd">        :param precision: Precission of the converted value.</span>
<span class="sd">        :return: A string with the value in the more &#39;sensible&#39; units and the units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">negative</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">value</span> <span class="o">*=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="n">negative</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span>
        <span class="n">formatting</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%s%%</span><span class="s2">.</span><span class="si">%i</span><span class="s2">f </span><span class="si">%%</span><span class="s2">s&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">negative</span><span class="p">,</span> <span class="n">precision</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="n">dimension</span><span class="p">]</span>
        <span class="n">possibleUnits</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">formatting</span> <span class="o">%</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">allValues</span> <span class="o">=</span> <span class="p">[</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asUnit</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">unit</span><span class="p">)))</span> <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="n">possibleUnits</span><span class="p">]</span>
        <span class="n">bestUnit</span> <span class="o">=</span> <span class="n">possibleUnits</span><span class="p">[</span><span class="n">allValues</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">allValues</span><span class="p">))]</span>
        <span class="k">return</span> <span class="n">formatting</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">asUnit</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">bestUnit</span><span class="p">),</span> <span class="n">bestUnit</span><span class="p">)</span></div>

<div class="viewcode-block" id="UnitsSystem.eV"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.eV">[docs]</a>    <span class="k">def</span> <span class="nf">eV</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">e</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Transform an energy value in SI units in a string expresing the value in eV.</span>

<span class="sd">        &gt;&gt;&gt; print(eV(1e-19))</span>
<span class="sd">        0.624 eV</span>

<span class="sd">        :param e: Energy value in SI units</span>
<span class="sd">        :return: A string with the energy converted in eV and its units.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="s2">&quot;</span><span class="si">%.3f</span><span class="s2"> eV&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">asUnit</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="s2">&quot;eV&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="UnitsSystem.guess_dimension"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.guess_dimension">[docs]</a>    <span class="k">def</span> <span class="nf">guess_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Guess the dimension of a unit.</span>

<span class="sd">        &gt;&gt;&gt; print guess_dimension(&quot;nm&quot;)</span>
<span class="sd">        length</span>

<span class="sd">        :param unit: the unit.</span>
<span class="sd">        :return: None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">possibilities</span> <span class="o">=</span> <span class="p">[</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">unit</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="n">key</span><span class="p">]]</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">possibilities</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Guessing dimension of &#39;</span><span class="si">%s</span><span class="s2">&#39;: No candidates found&quot;</span> <span class="o">%</span> <span class="n">unit</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span>
            <span class="n">possibilities</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Guessing dimension of &#39;</span><span class="si">%s</span><span class="s2">&#39;: Multiple candidates found, please convert manually. (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="p">(</span>
            <span class="n">unit</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">possibilities</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">possibilities</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="UnitsSystem.list_dimensions"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.UnitsSystem.list_dimensions">[docs]</a>    <span class="k">def</span> <span class="nf">list_dimensions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="n">dim</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">is</span> <span class="ow">not</span> <span class="s2">&quot;&quot;</span><span class="p">])))</span></div></div>


<div class="viewcode-block" id="compare_floats"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.compare_floats">[docs]</a><span class="k">def</span> <span class="nf">compare_floats</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">absoulte_precision</span><span class="o">=</span><span class="mf">1e-12</span><span class="p">,</span> <span class="n">relative_precision</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Returns true if the absolute difference between the numbers a and b is less than the precision.</span>

<span class="sd">    Arguments:</span>
<span class="sd">    a -- a float</span>
<span class="sd">    b -- a float</span>

<span class="sd">    Keyword Arguments (optional):</span>
<span class="sd">    absolute_precision -- the absolute precision, abs(a-b) of the comparison.</span>
<span class="sd">    relative_precision -- the relative precision, max(a,b)/min(a,b) - 1. of the comparison.</span>

<span class="sd">    Returns:</span>
<span class="sd">    True if the numbers are the same within the limits of the precision.</span>
<span class="sd">    False if the number are not the same within the limits of the precision.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">relative_precision</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">absolute</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">absolute</span> <span class="o">&lt;</span> <span class="n">absoulte_precision</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">relative</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="nb">min</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.</span>
        <span class="k">if</span> <span class="n">relative</span> <span class="o">&lt;</span> <span class="n">relative_precision</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="independent_nm_ev"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.independent_nm_ev">[docs]</a><span class="k">def</span> <span class="nf">independent_nm_ev</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">UnitsSystem</span><span class="p">()</span><span class="o">.</span><span class="n">eVnm</span><span class="p">(</span><span class="n">x</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>


<div class="viewcode-block" id="independent_nm_J"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.independent_nm_J">[docs]</a><span class="k">def</span> <span class="nf">independent_nm_J</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">UnitsSystem</span><span class="p">()</span><span class="o">.</span><span class="n">nmJ</span><span class="p">(</span><span class="n">x</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">y</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>


<div class="viewcode-block" id="independent_m_J"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.independent_m_J">[docs]</a><span class="k">def</span> <span class="nf">independent_m_J</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">reverse</span><span class="p">(</span><span class="n">UnitsSystem</span><span class="p">()</span><span class="o">.</span><span class="n">mJ</span><span class="p">(</span><span class="n">x</span><span class="p">)),</span> <span class="n">reverse</span><span class="p">(</span><span class="n">y</span><span class="p">)</span></div>


<div class="viewcode-block" id="reverse"><a class="viewcode-back" href="../../../Systems/Units.html#solcore.units_system.units_system.reverse">[docs]</a><span class="k">def</span> <span class="nf">reverse</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span></div>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">UnitsSystem</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">solcore</span><span class="o">.</span><span class="n">eVnm</span><span class="p">(</span><span class="mi">1240</span><span class="p">))</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">Solcore 5.0.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Quantum Photovoltaics Group, Imperial College London.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.6.3.
    </div>
  </body>
</html>